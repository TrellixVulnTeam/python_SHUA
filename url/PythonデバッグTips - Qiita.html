<!DOCTYPE html>
<html xmlns:og="http://ogp.me/ns#"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><title>PythonデバッグTips - Qiita</title><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="

PythonデバッグTips

この記事は Python Advent Calendar 2016 24日目の記事です。今回はPythonのデバッグのTipsをいくつか紹介します。


print()でデバッグ

print()関数を使って確認したい値をstdoutに出力することでデバッグします。これで解決できるのであれば、それに越したことはありません。

FizzBuzzをデバッグします。今回は1から20までの数値を使ってFizzBuzzを出力したいとします。以下..." name="description"><meta content="summary" name="twitter:card"><meta content="@Qiita" name="twitter:site"><meta content="TakesxiSximada" name="twitter:creator"><meta content="PythonデバッグTips - Qiita" property="og:title"><meta content="article" property="og:type"><meta content="http://qiita.com/TakesxiSximada/items/45b6d71a44f2706798ed" property="og:url"><meta content="http://cdn.qiita.com/assets/qiita-fb-2887e7b4aad86fd8c25cea84846f2236.png" property="og:image"><meta content="# PythonデバッグTips

この記事は [Python Advent Calendar 2016](http://qiita.com/advent-calendar/2016/python) 24日目の記事です。今回はPyth..." property="og:description"><meta content="Qiita" property="og:site_name"><meta content="564524038" property="fb:admins"><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-4ff10c1e1e2b5fcb353ff9cafdd56c70.ico"><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-f9a6afad761ec2306e10db2736187c8b.png"><link href="http://qiita.com/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml"><link rel="stylesheet" media="all" href="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/public-4b8a79ceeeffda266a337e5dbb37d087.css"><meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="DsOMvTmcURwai36v3woZx8iR8Te1CdNBjxSWpPuwieqJPl2ssYq3JbqFWwFnr3ezRHebtHS2M/3PF9Gd+Z6o0w=="><script src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/ads"></script><script src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/gtm_002.js" async=""></script><script async="" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/cbgapi.loaded_1"></script><script async="" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/cbgapi.loaded_0"></script><script src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/button.js" async="" charset="utf-8" type="text/javascript"></script><script async="" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/pubads_impl_140.js"></script><link href="http://tpc.googlesyndication.com/safeframe/1-0-9/html/container.html?v=1-0-10" rel="prefetch"><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}</style></head><body class=" with-js"><noscript><iframe height="0" src="//www.googletagmanager.com/ns.html?id=GTM-TBQWPN" style="display:none;visibility:hidden" width="0"></iframe></noscript><script src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/gtm.js" async=""></script><script src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/analytics.js" async=""></script><script id="optimizely-jssdk" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/52738645.js" async=""></script><script id="google-analytics-jssdk" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/ga.js" async=""></script><script id="twitter-jssdk" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/widgets.js" async=""></script><script id="facebook-jssdk" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/all.js" async=""></script><script gapi_processed="true" id="google-plusone-jssdk" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/plusone.js" async=""></script><script id="pocket-btn-js" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/btn.js" async=""></script><script>
  document.body.className = document.body.className.replace('without-js', '') + ' with-js';
  window.Qiita = {"asset_host":"cdn.qiita.com","TLD":"com","controller_path":"public/items","controller_action":"public/items#show","controller":"items","action":"show","action_path":"public/items#show","env":"production","flash":{},"is_team_page":false,"request_parameters":{"controller":"public/items","action":"show","user_id":"TakesxiSximada","type":"items","id":"45b6d71a44f2706798ed"},"root_domain":"qiita.com","variant":null,"config":{"mixpanel":{"per_team":"c0a2116368b33b44b5029ebd2cc9b094","public":"be87616606b0e26a87689099aab2c4e5","team":"b7c0342acba2dbc8742484d98788efb3"},"default_locale":"ja","locale":"en"},"team":null,"user":null,"GIT_BRANCH":null,"DEBUG":false};

</script>
<div class="headerContainer headerContainer-public" role="navigation"><script type="application/json" class="js-react-on-rails-component" data-component-name="HeaderContainer" data-dom-id="HeaderContainer-react-component-40d75d28-01b7-4a58-b9b3-a6fec3d26e71">{"user":null,"team":null,"news":{"type":"PR","content":"Markdownによる情報共有サービス、Qiita:Team","url":"https://teams.qiita.com?utm_source=qiita\u0026utm_medium=header_news"},"initial_unread_count":null,"siteid_image":"https://cdn.qiita.com/siteid-reverse.png","is_team_page":false,"on_team_setting":false,"show_post_menu":true,"show_search_menu":true,"is_fluid":false,"locale":"en"}</script>
    <div id="HeaderContainer-react-component-40d75d28-01b7-4a58-b9b3-a6fec3d26e71"><header class="sharedHeader sharedHeader-public" data-reactroot=""><div class="sharedHeader_inner"><div class="sharedHeader_left"><span class="sharedHeader_logo open"><a href="http://qiita.com/" class="sharedHeader_logo_main"><span class="sharedHeader_logo_figure"><svg viewBox="0 0 75 26" xmlns="http://www.w3.org/2000/svg"><title>Qiita</title><path d="M24.6 12.2C24.6 6.2 20 0 12.2 0 6.2 0 0 4.6 0 12.4c0 6 4.6 12.2 12.4 12.2 2.5 0 5-.8 7.1-2.3l3.6 3.6 1.6-1.6-3.4-3.4c2.1-2.3 3.3-5.3 3.3-8.7zm-12.4-10c5.7 0 10.2 4.4 10.2 10.1 0 4.9-3.8 10.1-10.1 10.1s-10.1-5.1-10.1-10c0-6.4 5.1-10.2 10-10.2zM30.5 7.1h2.1v17h-2.1zM31.5 4.8c-1 0-1.8-.8-1.8-1.8s.8-1.8 1.8-1.8 1.8.8 1.8 1.8-.8 1.8-1.8 1.8zM40 4.8c-1 0-1.8-.8-1.8-1.8S39 1.2 40 1.2s1.8.8 1.8 1.8S41 4.8 40 4.8zM39 7.1h2.1v17H39zM53.7 24.4c-3.9 0-6.2-3-6.2-6v-16h2.1v4.7H57v2.1h-7.4v9.3c0 1.9 1.5 3.9 4.1 3.9.7 0 1.4-.2 2-.6l.2-.1 1 1.8-.2.1c-.9.5-2 .8-3 .8zM67.6 24.5c-5.7 0-9.1-4.5-9.1-8.9 0-5.7 4.5-9.1 8.9-9.1 2.3 0 4.1.8 5.4 2.3V7.1h2.1v17h-2.1v-1.9c-1.2 1.5-3 2.3-5.2 2.3zm-.2-15.9c-3.4 0-6.8 2.6-6.8 7 0 3.4 2.6 6.8 7 6.8 2 0 4-.9 5.3-2.5v-8.8c-1.4-1.6-3.3-2.5-5.5-2.5z"></path></svg></span></a></span><form method="get" action="/search" class="navbar-form navbar-left searchForm"><div class="searchForm_queryWrapper"><input name="q" autocomplete="off" placeholder="Search" class="form-control searchForm_query"><div style="" class="searchForm_wiseSearchButton"><i class="fa fa-caret-down"></i></div></div></form><div class="navbar-text headerNews hidden-xs hidden-sm"><div class="headerNews_label label label-warning">PR</div><a href="https://teams.qiita.com/?utm_source=qiita&amp;utm_medium=header_news" target="_blank" class="navbar-link">Markdownによる情報共有サービス、Qiita:Team</a></div></div><div class="sharedHeader_right"><div class="sharedHeader_registerUser"><a href="http://qiita.com/signup?redirect_to=%2FTakesxiSximada%2Fitems%2F45b6d71a44f2706798ed" class="btn btn-warning navbar-btn navbar-right">Sign up</a></div><div class="sharedHeader_loginUser"><a href="http://qiita.com/login?redirect_to=%2FTakesxiSximada%2Fitems%2F45b6d71a44f2706798ed" data-label="LoginButtonAtNavbar">Log in</a></div></div></div></header></div>
    
</div><div id="main"><script type="application/ld+json">{  "@context": "http://schema.org",  "@type": "BreadcrumbList",  "itemListElement": [    {      "@type": "ListItem",      "position": 1,      "item": {        "@id": "/",        "name": "Qiita"      }    },    {      "@type": "ListItem",      "position": 2,      "item": {        "@id": "/items",        "name": "Items"      }    },    {      "@type": "ListItem",      "position": 3,      "item": {        "@id": "/tags/Python",        "name": "Python"      }    }  ]}</script><article itemscope="" itemtype="http://schema.org/Article"><div class="ArticleMainHeader ArticleMainHeader--adcalItem"><div class="container"></div><div class="container"><div class="row s-flex-align-center"><div class="col-sm-9"><div class="adventCalendarRibbon"><span><a class="adventCalendarRibbon_title" href="http://qiita.com/advent-calendar/2016/python">Python Advent Calendar 2016</a> Day 24</span></div><h1 class="ArticleMainHeader__title" itemprop="headline">PythonデバッグTips</h1><ul class="TagList"><li class="TagList__item" data-count="11673"><a class="u-link-unstyled TagList__label" href="http://qiita.com/tags/Python"><img alt="Python" class="TagList__icon" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/medium.jpg"><span>Python</span></a></li></ul></div><div class="col-sm-3"><div class="itemsShowHeaderStock"><ul class="list-unstyled itemsShowHeaderStock_statusList"><li><div class="itemsShowHeaderStock_count stock"><span class="fa fa-thumbs-up"></span><span class="js-likecount">61</span></div><div class="itemsShowHeaderStock_countText">Like</div></li><li><div class="itemsShowHeaderStock_count" content="0 UserComments" itemprop="commentCount"><span class="fa fa-comment"></span>0</div><div class="itemsShowHeaderStock_countText">Comment</div></li></ul></div><div class="js-likebutton" data-props="{&quot;like_status&quot;:false,&quot;like_count&quot;:61,&quot;uuid&quot;:&quot;45b6d71a44f2706798ed&quot;,&quot;likable_type&quot;:&quot;Article&quot;,&quot;position&quot;:&quot;article-header&quot;}"><div class="LikeButton" data-reactroot=""><button class="p-button"><span class="fa fa-fw fa-thumbs-up"></span><span>Like</span></button></div></div><ul class="list-inline ArticleMainHeader__users"><li class="js-hovercard" data-hovercard-target-name="doridoridoriand"><a itemprop="url" href="http://qiita.com/doridoridoriand"><img alt="doridoridoriand" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473686872.png"></a></li><li class="js-hovercard" data-hovercard-target-name="shuheilocale@github"><a itemprop="url" href="http://qiita.com/shuheilocale@github"><img alt="shuheilocale@github" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473683617.png"></a></li><li class="js-hovercard" data-hovercard-target-name="meronmks"><a itemprop="url" href="http://qiita.com/meronmks"><img alt="meronmks" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1483621271.jpeg"></a></li><li class="js-hovercard" data-hovercard-target-name="jesushill"><a itemprop="url" href="http://qiita.com/jesushill"><img alt="jesushill" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473757578.jpeg"></a></li><li class="js-hovercard" data-hovercard-target-name="naohide_a"><a itemprop="url" href="http://qiita.com/naohide_a"><img alt="naohide_a" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473684128.jpeg"></a></li><li class="js-hovercard" data-hovercard-target-name="sintan"><a itemprop="url" href="http://qiita.com/sintan"><img alt="sintan" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473682384.gif"></a></li><li class="js-hovercard" data-hovercard-target-name="hi-sa"><a itemprop="url" href="http://qiita.com/hi-sa"><img alt="hi-sa" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473695180.png"></a></li><li class="js-hovercard" data-hovercard-target-name="teiji_40kara"><a itemprop="url" href="http://qiita.com/teiji_40kara"><img alt="teiji_40kara" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473711128.jpeg"></a></li><li class="js-hovercard" data-hovercard-target-name="RAGUNA2"><a itemprop="url" href="http://qiita.com/RAGUNA2"><img alt="RAGUNA2" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473694534.jpeg"></a></li><li class="js-hovercard" data-hovercard-target-name="keisukefukuda@github"><a itemprop="url" href="http://qiita.com/keisukefukuda@github"><img alt="keisukefukuda@github" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1491725526.jpeg"></a></li><li><a href="http://qiita.com/TakesxiSximada/items/45b6d71a44f2706798ed/likers"><span class="fa fa-ellipsis-h"></span></a></li></ul></div></div></div></div><div class="ArticleAsideHeader"><div class="container"><div class="u-flex u-space-between"><div class="u-flex u-flex-wrap"><div class="u-flex u-align-center s-pdv-5 u-flex-wrap"><div class="ArticleAsideHeader__author"><a href="http://qiita.com/TakesxiSximada"><img class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473687011.png" alt="1473687011"></a> <a class="u-link-unstyled" href="http://qiita.com/TakesxiSximada">TakesxiSximada</a> </div><div class="ArticleAsideHeader__date"><meta content="2016-12-25T00:50:38+09:00" itemprop="datePublished"><span data-original-title="posted at 2016-12-25" data-toggle="tooltip" title="">Edited at <time datetime="2017-02-03T08:58:26+09:00" itemprop="dateModified">2017-02-03</time></span></div></div><div class="u-flex u-align-center s-pdv-5 mobile-hidden"><div class="ArticleAsideHeader__revision"> <a data-original-title="Revisions" data-toggle="tooltip" title="" href="http://qiita.com/TakesxiSximada/items/45b6d71a44f2706798ed/revisions"><span class="fa fa-history"></span></a><span class="ArticleAsideHeader__revisionCount">6</span></div></div><div class="u-flex u-align-center s-pdv-5 mobile-hidden"></div></div><div class="u-flex u-align-center s-flex-justiry-between s-pdv-5 u-shrink-0"><div class="ArticleAsideHeader__stock"><div class="js-stockbutton" data-position="top" data-props="{&quot;stock_status&quot;:false}"><div class="StockButton" data-reactroot=""><button><div class="StockButton__stock"><div class="fa-stack"><span class="fa fa-folder-open fa-stack-1x unstock"></span></div><!-- react-text: 6 -->&nbsp;<!-- /react-text --><span class="StockButton__label">Stock</span></div></button></div></div></div><div class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#"><span class="fa fa-ellipsis-h fa-lg"></span></a><ul class="dropdown-menu dropdown-menu-right"><li class="dropdown__item--mobile"><a href="http://qiita.com/TakesxiSximada/items/45b6d71a44f2706798ed/revisions"><span class="fa fa-fw fa-history"></span> Revisions<span>(6)</span></a></li><li><a href="http://qiita.com/TakesxiSximada/items/45b6d71a44f2706798ed.md"><span class="fa fa-fw fa-file-text-o"></span> Show article as Markdown</a></li><li><a data-target=".js-report-form" data-toggle="modal" href="#"><span class="fa fa-fw fa-flag"></span> Report article</a></li></ul></div></div></div></div></div><div class="container"><div style="position: relative;" class="row" id="article-body-wrapper"><div class="col-sm-9"><section class="markdownContent markdownContent-headingEnabled js-task-list-container clearfix position-relative" id="item-45b6d71a44f2706798ed" itemprop="articleBody">
<h1>
<span id="pythonデバッグtips" class="fragment"></span><a href="#python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0tips"><i class="fa fa-link"></i></a>PythonデバッグTips</h1>

<p>この記事は <a href="http://qiita.com/advent-calendar/2016/python">Python Advent Calendar 2016</a> 24日目の記事です。今回はPythonのデバッグのTipsをいくつか紹介します。</p>

<h2>
<span id="printでデバッグ" class="fragment"></span><a href="#print%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%B0"><i class="fa fa-link"></i></a>print()でデバッグ</h2>

<p>print()関数を使って確認したい値をstdoutに出力することでデバッグします。これで解決できるのであれば、それに越したことはありません。</p>

<p>FizzBuzzをデバッグします。今回は1から20までの数値を使ってFizzBuzzを出力したいとします。以下のコードには明らかなバグがあります。わかりますか?</p>

<p>example_fizzbuzz_buggy.py::</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>for ii in range(1, 21):
    if ii % 3 == 0:
        print('Fizz')
    elif ii % 5 == 0:
        print('Buzz')
    elif ii % 15 == 0:
        print('FizzBuzz')
    else:
        print(ii)

</pre></div></div>

<p>これを実行するとexample_fizzbuzz.pyは次のメッセージを表示します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ python example_fizzbuzz.py
1
2
Fizz
4
Buzz
Fizz
7
8
Fizz
Buzz
11
Fizz
13
14
Fizz
16
17
Fizz
19
Buzz
</pre></div></div>

<p>何かおかしいですね。<code>FizzBuzz</code> という表示が1個もありません。15の場合は<code>FizzBuzz</code>を表示するべきです。15の時の挙動を確認するためにprint()を追加してみます。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>for ii in range(1, 21):
    print('CURRENT: {}'.format(ii))  # 追加
    if ii % 3 == 0:
        print('Fizz')
    elif ii % 5 == 0:
        print('Buzz')
    elif ii % 15 == 0:
        print('HIT')  # 追加
        print('FizzBuzz')
    else:
        print(ii)
</pre></div></div>

<p><code>追加</code> とコメントした行が追加したprint()です。以下のデバッグメッセージを出力するためにコードを追加しました。</p>

<ul>
<li>現在の数値を <code>CUURENT: 1</code> のように表示する</li>
<li>数値が15で割り切れた時 <code>HIT</code> と表示する</li>
</ul>

<p>では実行します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ python  example_fizzbuzz.py
CURRENT: 1
1
CURRENT: 2
2
CURRENT: 3
Fizz
CURRENT: 4
4
CURRENT: 5
Buzz
CURRENT: 6
Fizz
CURRENT: 7
7
CURRENT: 8
8
CURRENT: 9
Fizz
CURRENT: 10
Buzz
CURRENT: 11
11
CURRENT: 12
Fizz
CURRENT: 13
13
CURRENT: 14
14
CURRENT: 15
Fizz
CURRENT: 16
16
CURRENT: 17
17
CURRENT: 18
Fizz
CURRENT: 19
19
CURRENT: 20
Buzz
</pre></div></div>

<p><code>CURRENT: 15</code> の時は <code>Fizz</code> を表示していて、<code>HIT</code> は表示していません。ということは <code>if ii % 3 == 0:</code> のブロックを実行しており <code>elif ii % 15 == 0:</code> のブロックは実行していないことがわかります。ii が 15の場合は当然3で割り切れるので <code>if ii % 3 == 0:</code> はTrueになり、その後ろの <code>elif ii % 15 == 0:</code> が <code>elif</code> のため実行されていません。<code>ii % 15 == 0</code> は他の条件よりも先に分岐しなければならないことがわかったのでコードを直します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ python example_fizzbuzz.py
CURRENT: 1
1
CURRENT: 2
2
CURRENT: 3
Fizz
CURRENT: 4
4
CURRENT: 5
Buzz
CURRENT: 6
Fizz
CURRENT: 7
7
CURRENT: 8
8
CURRENT: 9
Fizz
CURRENT: 10
Buzz
CURRENT: 11
11
CURRENT: 12
Fizz
CURRENT: 13
13
CURRENT: 14
14
CURRENT: 15
HIT
FizzBuzz
CURRENT: 16
16
CURRENT: 17
17
CURRENT: 18
Fizz
CURRENT: 19
19
CURRENT: 20
Buzz
</pre></div></div>

<p>15の場合、<code>HIT</code> と <code>FizzBuzz</code> を表示しています。良さそうですね。バグが取り除かれました。あとは先ほど追加されたprint()を削除します。最終的なコードはこのようになります。</p>

<p>example_fizzbuzz.py::</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>for ii in range(1, 21):
    if ii % 15 == 0:
        print('FizzBuzz')
    elif ii % 3 == 0:
        print('Fizz')
    elif ii % 5 == 0:
        print('Buzz')
    else:
        print(ii)
</pre></div></div>

<p>この手法はどのプログラミング言語でもよく使われるものです。そして最後のprint()を削除し忘れるというのもよくやってしまいがちです。忘れず削除するようにしましょう。</p>

<h2>
<span id="pdbを使って1行ずつプログラムの動きを確認する" class="fragment"></span><a href="#pdb%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A61%E8%A1%8C%E3%81%9A%E3%81%A4%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%AE%E5%8B%95%E3%81%8D%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>pdbを使って1行ずつプログラムの動きを確認する</h2>

<p>print()を使ってデバッグではデバッグメッセージをstdoutに出力することでプログラムがどのように動くかを確認しました。単純なプログラムであれば処理を追いかけられますが、複雑になってくるとデバッグメッセージだけでは動きがわかりにくくなります。<a href="http://docs.python.jp/3/library/pdb.html" rel="nofollow noopener" target="_blank">pdb</a> を使うとプログラムを1行ずつ確認しながら実行したり、その時の変数の値を確認できるため、よりプログラムの処理を追いかけやすくなります。</p>

<p>では先ほどの不具合入りの <code>example_fizzbuzz_buggy.py</code> をpdbを使って実行します。<br>
pdbは標準ライブラリなのでpipでインストールする必要はありません。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ python -m pdb example_fizzbuzz_buggy.py
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(1)&lt;module&gt;()
-&gt; for ii in range(1, 21):
(Pdb)
</pre></div></div>

<p>Pythonの引数に <code>-m pdb</code> を追加します。pdbで実行したスクリプトは最初に実行するコードで停止し、入力を待ちます。ここでpdbコマンドを指定してENTERを入力することで、デバッガを操作します。pdbコマンドの詳細は <a href="http://docs.python.jp/3/library/pdb.html#debugger-commands" rel="nofollow noopener" target="_blank">27.3. pdb — Python デバッガー — Python 3.5.2 ドキュメント</a> で解説されています。</p>

<p>1行ずつ実行するには n (nextの意味) を入力します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>(Pdb) n
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt; if ii % 3 == 0:
(Pdb)
</pre></div></div>

<p>pdbは1行実行し、次に実行する行を表示しました。</p>

<p>この時表示された <code>&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()</code> は次のフォーマットをしています。</p>

<p><code>&gt; ファイルパス(実行している行数)関数名()</code></p>

<p>今回は関数にしていないので関数名の所は <code>&lt;module&gt;</code> という表示になっています。(実際には__name__の値を表示します)</p>

<p>ENTERだけ(コマンドの指定なし)の場合は、1個前のpdbコマンドを実行することになります。<br>
そのためもう一行処理させたい場合は、ENTERを入力します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>(Pdb)
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(4)&lt;module&gt;()
-&gt; elif ii % 5 == 0:
(Pdb)
</pre></div></div>

<p>l (listの意味) を使うと現在どこの行を実行しているか確認できます。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>(Pdb) l
  1     for ii in range(1, 21):
  2         if ii % 3 == 0:
  3             print('Fizz')
  4  -&gt;     elif ii % 5 == 0:
  5             print('Buzz')
  6         elif ii % 15 == 0:
  7             print('FizzBuzz')
  8         else:
  9             print(ii)
[EOF]
(Pdb)
</pre></div></div>

<p><code>-&gt;</code> がマークされている行を次に実行します。<br>
1行ずつではなく処理を進めたい場合は、c (continueの意味) を指定します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>(Pdb) c
1
2
Fizz
4
Buzz
Fizz
7
8
Fizz
Buzz
11
Fizz
13
14
Fizz
16
17
Fizz
19
Buzz
The program finished and will be restarted
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(1)&lt;module&gt;()
-&gt; for ii in range(1, 21):
</pre></div></div>

<p>プログラムを最後まで実行しました。最後までプログラムを処理するとpdbは <code>The program finished and will be restarted</code> を出力し、プログラムを再実行します。</p>

<p>行数を指定して処理を停止させたい場合、ブレイクポイントを使います。iiが15の時の処理を確認するため、b (breakの意味) コマンドを使ってif文で最初に分岐している2行目にブレイクポイントを設定します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>(Pdb) b 2
Breakpoint 1 at /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py:2
(Pdb)
</pre></div></div>

<p>これで2行目が処理される前にプログラムが一時停止します。cコマンドを使って処理を進めましょう。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>(Pdb) c
1
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt; if ii % 3 == 0:
(Pdb)
</pre></div></div>

<p>停止しました。p (printの意味) コマンドを使ってiiの値が何かを確認します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>(Pdb) p ii
2
(Pdb)
</pre></div></div>

<p>2ですね。15の時の処理を確認したいので、cをあと13回実行しましょう。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>(Pdb) c
2
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt; if ii % 3 == 0:
(Pdb) c
Fizz
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt; if ii % 3 == 0:
(Pdb) c
4
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt; if ii % 3 == 0:
(Pdb) c
Buzz
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt; if ii % 3 == 0:
(Pdb) c
Fizz
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt; if ii % 3 == 0:
(Pdb) c
7
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt; if ii % 3 == 0:
(Pdb) c
8
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt; if ii % 3 == 0:
(Pdb) c
Fizz
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt; if ii % 3 == 0:
(Pdb) c
Buzz
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt; if ii % 3 == 0:
(Pdb) c
11
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt; if ii % 3 == 0:
(Pdb) c
Fizz
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt; if ii % 3 == 0:
(Pdb) c
13
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt; if ii % 3 == 0:
(Pdb) c
14
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt; if ii % 3 == 0:
(Pdb) p ii
15
(Pdb)
</pre></div></div>

<p>上記ではcを何度も入力しましたが、停止する条件も設定できます。<br>
今回はiiが15の時に停止して欲しいので、次のように条件を指定します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>(Pdb) b 2, ii == 15
Breakpoint 3 at /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py:2
(Pdb)
</pre></div></div>

<p>そしてcを実行するとiiが15の時だけ停止するので、cを何度も入力する必要はありません。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>(Pdb) c
1
2
Fizz
4
Buzz
Fizz
7
8
Fizz
Buzz
11
Fizz
13
14
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt; if ii % 3 == 0:
(Pdb) p ii
15
(Pdb)
</pre></div></div>

<p>あとはnで1行ずつ実行し動作を確認します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>(Pdb) n
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(3)&lt;module&gt;()
-&gt; print('Fizz')
(Pdb) n
Fizz
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(1)&lt;module&gt;()
-&gt; for ii in range(1, 21):
(Pdb)
</pre></div></div>

<p>3行目が実行されたあと1行目のfor文が処理される(つまり6行目の <code>elif ii % 15 == 0:</code> が処理されていない)ことがわかります。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>(Pdb) list
  1  -&gt; for ii in range(1, 21):
  2 B       if ii % 3 == 0:
  3             print('Fizz')
  4         elif ii % 5 == 0:
  5             print('Buzz')
  6         elif ii % 15 == 0:
  7             print('FizzBuzz')
  8         else:
  9             print(ii)
[EOF]
(Pdb)
</pre></div></div>

<p>iiが15の時には <code>ii % 3 == 0</code> はTrueなので、このif-elif-elseでは15の時に正しく動作しないことをpdbを使って確認しました。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>(Pdb) p ii
15
(Pdb) p ii % 3 == 0
True
(Pdb)
</pre></div></div>

<p>ブレイクポイントは cl (clearの意味) を使って削除します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>(Pdb) cl
Clear all breaks? yes
Deleted breakpoint 3 at /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py:2
(Pdb)
</pre></div></div>

<p>呼び出した関数の処理を確認するには、s (stepの意味) を指定します。</p>

<p>example_fizzbuzz_buggy2.py::</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>def fizzbuzz(num):
    if ii % 3 == 0:
        print('Fizz')
    elif ii % 5 == 0:
        print('Buzz')
    elif ii % 15 == 0:
        print('FizzBuzz')
    else:
        print(ii)

for ii in range(1, 21):
    fizzbuzz(ii)
</pre></div></div>

<p>example_fizzbuzz_buggy2.pyでfizzbuzz関数に入ってみます。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ python -m pdb example_fizzbuzz_buggy2.py
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy2.py(1)&lt;module&gt;()
-&gt; def fizzbuzz(num):
(Pdb) n
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy2.py(11)&lt;module&gt;()
-&gt; for ii in range(1, 21):
(Pdb) n
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy2.py(12)&lt;module&gt;()
-&gt; fizzbuzz(ii)
(Pdb) p ii
1
</pre></div></div>

<p>ここまでは先ほど解説した内容を使って、12行目のfizzbuzz()呼び出しまで処理を進めています。</p>

<p>次にsを指定してfizzbuzz()の内部で処理を停止させています。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>(Pdb) s
--Call--
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy2.py(1)fizzbuzz()
-&gt; def fizzbuzz(num):
(Pdb) n
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy2.py(2)fizzbuzz()
-&gt; if ii % 3 == 0:
(Pdb)
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy2.py(4)fizzbuzz()
-&gt; elif ii % 5 == 0:
</pre></div></div>

<p>fizzbuzz()の関数が終了したところまで処理を進めるには、r (returnの意味) を指定します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>(Pdb) r
1
--Return--
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy2.py(9)fizzbuzz()-&gt;None
-&gt; print(ii)
(Pdb) n
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy2.py(11)&lt;module&gt;()
-&gt; for ii in range(1, 21):
</pre></div></div>

<p><code>fizzbuzz()-&gt;None</code> はfizzbuzz()がNoneを返したことを表しています。</p>

<h3>
<span id="コード内に-import-pdb-pdbset_trace-を記述する" class="fragment"></span><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E5%86%85%E3%81%AB-import-pdb-pdbset_trace-%E3%82%92%E8%A8%98%E8%BF%B0%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>コード内に <code>import pdb; pdb.set_trace()</code> を記述する</h3>

<p>pdbを使うために <code>python -m pdb</code> で実行していましたが、これでは起動のオプションを変更しなければなりません。これでは、起動スクリプトを作成していたりPythonを直接呼び出さない場合にpdbを使えません。</p>

<p>pdbはそのためにset_trace()を提供しています。set_trace()が呼び出された時にpdbのデバッグモードに切り替わり、コマンドの入力を待ちます。</p>

<p>example_fizzbuzz_buggy.pyにset_trace()を仕込みます。</p>

<p>example_fizzbuzz_buggy.py::</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>for ii in range(1, 21):
    if ii % 3 == 0:
        print('Fizz')
    elif ii % 5 == 0:
        import pdb; pdb.set_trace()  # 追加
        print('Buzz')
    elif ii % 15 == 0:
        print('FizzBuzz')
    else:
        print(ii)
</pre></div></div>

<p>5行目に <code>import pdb; pdb.set_trace()</code> を追加しました。<br>
example_fizzbuzz_buggy.py実行しますが、今回は <code>-m pdb</code> は指定しません。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ python  example_fizzbuzz_buggy.py
1
2
Fizz
4
&gt; /working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(6)&lt;module&gt;()
-&gt; print('Buzz')
(Pdb)
</pre></div></div>

<p>6行目で停止しました。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>(Pdb) l
  1     for ii in range(1, 21):
  2         if ii % 3 == 0:
  3             print('Fizz')
  4         elif ii % 5 == 0:
  5             import pdb; pdb.set_trace()
  6  -&gt;         print('Buzz')
  7         elif ii % 15 == 0:
  8             print('FizzBuzz')
  9         else:
 10             print(ii)
[EOF]
(Pdb)
</pre></div></div>

<p>set_trace()の次の行で処理が停止しています。<br>
この方法を使えば起動オプションを変更することなくpdbを起動できます。</p>

<p>このデバッグコードはデバッグ終了時には必ず削除しなければなりません。<br>
もし削除し忘れてしまった場合、本番の動作中にpdbが起動し入力待ちになるからです。<br>
print()でのデバッグと違い、必ず実害が発生します。<br>
GitのコミットフックやCIのテストでpdbの混入をチェックすることを勧めます。</p>

<p><code>import pdb; pdb.set_trace()</code> は2つの文が指定されていて、片方はimport文です。<br>
本来であればimport文はファイルの先頭に記述することが好まれますが、<br>
このデバッグコードはデバッグ終了時には必ず消さなければならないため、<br>
消す行を減らすために1行で記述しています。<br>
Pythonの公式ドキュメントにもこのように紹介されており、<br>
慣習的にもそれに習い1行で記述します。</p>

<h2>
<span id="ipdbでデバッグ" class="fragment"></span><a href="#ipdb%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%B0"><i class="fa fa-link"></i></a>ipdbでデバッグ</h2>

<p>ipdbはpdbの機能をIPythonを使って拡張したライブラリです。</p>

<p>ipdbはpipでインストールします。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ pip install ipdb
</pre></div></div>

<p><code>-m ipdb</code> をPythonの起動オプションに指定するか、<code>import ipdb; ipdb.set_trace()</code> をコード内に記述することで起動します。<br>
コードハイライトされていて見やすいです。</p>

<p><a href="https://qiita-image-store.s3.amazonaws.com/0/36261/c2a80285-a504-692e-3037-f7e6ddbd9c99.png" target="_blank" rel="nofollow noopener"><img src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/c2a80285-a504-692e-3037-f7e6ddbd9c99.png" alt="スクリーンショット 2016-12-24 20.52.10.png"></a></p>

<p>タブを押すと属性一覧を表示できます。</p>

<p><a href="https://qiita-image-store.s3.amazonaws.com/0/36261/a4c37b64-50fd-0d15-2c3a-069e8fe6884c.png" target="_blank" rel="nofollow noopener"><img src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/a4c37b64-50fd-0d15-2c3a-069e8fe6884c.png" alt="スクリーンショット 2016-12-24 20.52.34.png"></a></p>

<p>その他、使用方法はpdbとほぼ同じです。</p>

<h2>
<span id="bpdbでデバッグ" class="fragment"></span><a href="#bpdb%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%B0"><i class="fa fa-link"></i></a>bpdbでデバッグ</h2>

<p>bpdbはpdbの機能をBPythonを使って拡張したライブラリです。<br>
こちらはBPython自体の1機能として提供されています。</p>

<p>bpdbはpipでbpythonをインストールします。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ pip install bpython
</pre></div></div>

<p><code>-m bpdb</code> をPythonの起動オプションに指定するか、<code>import bpdb; bpdb.set_trace()</code> をコード内に記述することで起動します。<br>
pdbと同様に動作しますが、<code>B</code> を入力すると現在のスタックフレームでBPythonが起動します。</p>

<p><a href="https://qiita-image-store.s3.amazonaws.com/0/36261/b9413100-e2c8-551b-c192-059be3ba381d.png" target="_blank" rel="nofollow noopener"><img src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/b9413100-e2c8-551b-c192-059be3ba381d.png" alt="スクリーンショット 2016-12-24 21.16.30.png"></a></p>

<p>BPythonの終了は <code>C-d</code> です。</p>

<h2>
<span id="pudbでデバッグ" class="fragment"></span><a href="#pudb%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%B0"><i class="fa fa-link"></i></a>pudbでデバッグ</h2>

<p><a href="https://mathema.tician.de/debug-python-in-style/" rel="nofollow noopener" target="_blank">PuDB</a> はコンソール上で使える高機能なデバッガです。</p>

<p>インストールします。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>pip install pudb
</pre></div></div>

<p>インストールするとpudb3というコマンド(Python3の場合)が使えるようになります。<br>
pudb3に実行したいファイルパスを指定することで起動します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ pudb3 example_fizzbuzz_buggy.py
</pre></div></div>

<p>デバッガのペインはpdbの操作と同じです。<code>C-x</code> でデバッガのペインとインタラクティブシェルのペインを行き来できます。</p>

<p><a href="https://qiita-image-store.s3.amazonaws.com/0/36261/b60e9474-debb-cb2f-2377-0c180702141b.png" target="_blank" rel="nofollow noopener"><img src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/b60e9474-debb-cb2f-2377-0c180702141b.png" alt="スクリーンショット 2016-12-25 0.15.41.png"></a></p>

<p>テーマなどを設定でき、設定値は~/.config/pudb/pudb.cfgに保存しています。</p>

<p>~/.config/pudb/pudb.cfg::</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>[pudb]
breakpoints_weight = 1
current_stack_frame = top
custom_stringifier =
custom_theme =
display = auto
line_numbers = True
prompt_on_quit = True
seen_welcome = e027
shell = classic
sidebar_width = 0.5
stack_weight = 1
stringifier = type
theme = dark vim
variables_weight = 1
wrap_variables = True
</pre></div></div>

<h2>
<span id="pycharmでデバッグ" class="fragment"></span><a href="#pycharm%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%B0"><i class="fa fa-link"></i></a>PyCharmでデバッグ</h2>

<p><a href="https://www.jetbrains.com/pycharm" rel="nofollow noopener" target="_blank">PyCharm</a> はJetBrains社が開発したPythonのIDEです。GUI操作でデバッガを操作できます。とても直感的に操作することができ素晴らしいです。インストーラは <a href="https://www.jetbrains.com/pycharm/download/" class="autolink" rel="nofollow noopener" target="_blank">https://www.jetbrains.com/pycharm/download/</a> からダウンロードできます。</p>

<p>ファイルを開き、ブレイクポイントを設定してみます。</p>

<p><a href="https://qiita-image-store.s3.amazonaws.com/0/36261/31a5a886-5c37-7ca9-1718-88c38fed7498.png" target="_blank" rel="nofollow noopener"><img src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/31a5a886-5c37-7ca9-1718-88c38fed7498.png" alt="スクリーンショット 2016-12-25 0.37.53.png"></a></p>

<p>行番号表示の右側をクリックすると赤丸が出現します。これがデバッガです。VSとかEclipseとかと同じですね。</p>

<p>実行はメニューから [Run] &gt; [Debug]、 (もしくは虫マーク<br>
)をクリックします。</p>

<p><a href="https://qiita-image-store.s3.amazonaws.com/0/36261/bb58c79b-ea17-37f2-79a6-f77a4cd28052.png" target="_blank" rel="nofollow noopener"><img src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/bb58c79b-ea17-37f2-79a6-f77a4cd28052.png" alt="スクリーンショット 2016-12-25 0.41.05.png"></a></p>

<p>虫マーク</p>

<p><a href="https://qiita-image-store.s3.amazonaws.com/0/36261/60033b9a-7aeb-97aa-143b-222e9b9b7a83.png" target="_blank" rel="nofollow noopener"><img src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/60033b9a-7aeb-97aa-143b-222e9b9b7a83.png" alt="スクリーンショット 2016-12-25 0.41.26.png"></a></p>

<p>実行するとブレイクポイントで止まり、スタックフレームや変数がペインに表示されます。</p>

<p><a href="https://qiita-image-store.s3.amazonaws.com/0/36261/f58ba432-f7ed-ceab-d989-62e69aa5874d.png" target="_blank" rel="nofollow noopener"><img src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/f58ba432-f7ed-ceab-d989-62e69aa5874d.png" alt="スクリーンショット 2016-12-25 0.38.40.png"></a></p>

<p>細かい操作はアイコンが有効になるのでそれをクリックすれば操作できるし、マウスオーバーすれば何を行うアイコンかを表示します。</p>

<p><a href="https://qiita-image-store.s3.amazonaws.com/0/36261/e726f6af-4732-7e71-bbb1-0e662a23d4f6.png" target="_blank" rel="nofollow noopener"><img src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/e726f6af-4732-7e71-bbb1-0e662a23d4f6.png" alt="スクリーンショット 2016-12-25 0.42.37.png"></a></p>

<p>またProfessional Editionではリモートデバッグ機能が使えます。</p>

<h2>
<span id="いろんなシーンでデバッグする" class="fragment"></span><a href="#%E3%81%84%E3%82%8D%E3%82%93%E3%81%AA%E3%82%B7%E3%83%BC%E3%83%B3%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%B0%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>いろんなシーンでデバッグする</h2>

<h2>
<span id="unittestでデバッガを使いたくなったら" class="fragment"></span><a href="#unittest%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89"><i class="fa fa-link"></i></a>unittestでデバッガを使いたくなったら</h2>

<p>unittestでエラーになるけど原因がわからない場合、testコードでデバッグしたくなります。<br>
その場合はテストコード内に <code>pdb.set_trace()</code> を仕込み、pdbを起動できます。</p>

<p>例えば以下のテストコードでテスト実行時にpdbを起動します。</p>

<p>test_main.py::</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>from unittest import TestCase


def create_message(count):
    return 'Fish: {}'.format(count)


class SimpleTest(TestCase):
    def test_it(self):
        import pdb; pdb.set_trace()  # デバッグコード
        msg = create_message(1)
        self.assertEqual(msg, 'Fish: 1')
</pre></div></div>

<p>unittestを実行するとpdbが起動します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ python -m unittest
&gt; /working/advent-calendar-2016-python/test_main.py(11)test_it()
-&gt; msg = create_message(1)
(Pdb) list
  6
  7
  8     class SimpleTest(TestCase):
  9         def test_it(self):
 10             import pdb; pdb.set_trace()  # デバッグコード
 11  -&gt;         msg = create_message(1)
 12             self.assertEqual(msg, 'Fish: 1')
[EOF]
(Pdb)
</pre></div></div>

<h2>
<span id="noseでデバッガを使いたくなったら" class="fragment"></span><a href="#nose%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89"><i class="fa fa-link"></i></a>noseでデバッガを使いたくなったら</h2>

<p><a href="https://nose.readthedocs.io/en/latest/" rel="nofollow noopener" target="_blank">nose</a> はよく使われるテストフレームワークです。<br>
先ほどのようにテストを途中でpdbを使って停止させる場合、<code>--nocapture</code> を指定します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ nosetests --nocapture
&gt; /working/advent-calendar-2016-python/test_main.py(11)test_it()
-&gt; msg = create_message(1)
(Pdb)
</pre></div></div>

<p>またエラーや失敗した時にpdbを起動するための <code>--pdb</code>、 <code>--pdb-failures</code>、<code>--pdb-errors</code> も提供されています。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ nosetests --pdb
&gt; /Users/sximada/ng2/var/lib/miniconda3/envs/py3.5.2/lib/python3.5/unittest/case.py(665)fail()
-&gt; raise self.failureException(msg)
(Pdb)
</pre></div></div>

<p>noseのドキュメントには <code>Warning nose itself supports python 3, but many 3rd-party plugins do not!</code> と記述がある通り、<br>
nose自体ではなく、noseのpluginのPython3対応が進んでいないようです。</p>

<h2>
<span id="pytestでデバッガを使いたくなったら" class="fragment"></span><a href="#pytest%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89"><i class="fa fa-link"></i></a>pytestでデバッガを使いたくなったら</h2>

<p><a href="http://docs.pytest.org/en/latest/" rel="nofollow noopener" target="_blank">pytest</a> もnose同様よく使われるテストフレームワークです。<br>
<a href="http://docs.pytest.org/en/latest/" rel="nofollow noopener" target="_blank">pytest</a> はそのまま実行すれば、set_trace()実行時にpdbが起動します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ pytest
================================================================================ test session starts ================================================================================
platform darwin -- Python 3.5.2, pytest-3.0.5, py-1.4.32, pluggy-0.4.0
rootdir: /working/advent-calendar-2016-python, inifile:
plugins: celery-4.0.0
collected 1 items

test_main.py
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; PDB set_trace (IO-capturing turned off) &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; /working/advent-calendar-2016-python/test_main.py(11)test_it()
-&gt; msg = create_message(1)
(Pdb)
</pre></div></div>

<p><code>--pdb</code> を指定することでエラー時にデバッガを起動できます。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ pytest --pdb
================================================================================ test session starts ================================================================================
platform darwin -- Python 3.5.2, pytest-3.0.5, py-1.4.32, pluggy-0.4.0
rootdir: /working/advent-calendar-2016-python, inifile:
plugins: celery-4.0.0
collected 2 items

test_main.py F
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; traceback &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;

self = &lt;test_main.SimpleTest testMethod=test_error&gt;

    def test_error(self):
        msg = create_message(1)
&gt;       self.assertEqual(msg, 'ERROR')
E       AssertionError: 'Fish: 1' != 'ERROR'
E       - Fish: 1
E       + ERROR

test_main.py:15: AssertionError
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; entering PDB &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; /Users/sximada/ng2/var/lib/miniconda3/envs/py3.5.2/lib/python3.5/unittest/case.py(665)fail()
-&gt; raise self.failureException(msg)
(Pdb)
</pre></div></div>

<h2>
<span id="djangoでデバッガを使いたくなったら" class="fragment"></span><a href="#django%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89"><i class="fa fa-link"></i></a>Djangoでデバッガを使いたくなったら</h2>

<p><a href="https://www.djangoproject.com/" rel="nofollow noopener" target="_blank">Django</a> はよく使われるウェブフレームワークです。<br>
<a href="https://www.djangoproject.com/" rel="nofollow noopener" target="_blank">Django</a> でpdbを使うことは<br>
開発サーバ(<code>manage.py runserver</code>)であれば何も難しくありません。</p>

<p>プロジェクトを作成してpdbを起動してみます。</p>

<p>プロジェクトの構成は以下の通りです。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ tree proj
proj
├── __init__.py
├── settings.py
├── urls.py
└── wsgi.py
</pre></div></div>

<p>proj/urls.pyは次のように記述します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>from django.conf.urls import url
from django.http import HttpResponse


def top_view(request):
    import pdb; pdb.set_trace()
    return HttpResponse('OK')

urlpatterns = [
    url(r'^$', top_view),
]
</pre></div></div>

<p><code>/</code> にアクセスすると<code>OK</code>とリクエストを返すViewを定義しています。<br>
(ファイルを分割するのが面倒だったのでviewもurls.pyに記述しています)<br>
View関数内にはpdb.set_trac()を記述しています。</p>

<p>runserverで開発サーバを起動します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ python manage.py runserver
Performing system checks...

System check identified no issues (0 silenced).
December 24, 2016 - 13:45:26
Django version 1.11.dev20161224024349, using settings 'proj.settings'
Starting development server at http://127.0.0.1:8000/
Quit the server with CONTROL-C.
</pre></div></div>

<p>URLにリクエストを送信します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ curl http://127.0.0.1:8000/
</pre></div></div>

<p>開発サーバはpdb.set_trace()によってpdbを起動し入力を待ちます。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>&gt; /working/advent-calendar-2016-python/proj/urls.py(7)top_view()
-&gt; return HttpResponse('OK')
(Pdb)
</pre></div></div>

<p>後はデバッグするだけです。リクエストオブジェクトの中身を確認も確認できます。他のWAFも同様にpdbでデバッグできることが多いです。</p>

<h2>
<span id="gunicornでデバッガを使いたくなったら" class="fragment"></span><a href="#gunicorn%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89"><i class="fa fa-link"></i></a>gunicornでデバッガを使いたくなったら</h2>

<p><a href="http://gunicorn.org/" rel="nofollow noopener" target="_blank">gunicorn</a> はよく使われるWSGI HTTP Serverです。<br>
先ほどのDjango Projectを <a href="http://gunicorn.org/" rel="nofollow noopener" target="_blank">gunicorn</a> で実行します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ gunicorn proj.wsgi:application
[2016-12-24 22:53:59 +0900] [8915] [INFO] Starting gunicorn 19.6.0
[2016-12-24 22:53:59 +0900] [8915] [INFO] Listening at: http://127.0.0.1:8000 (8915)
[2016-12-24 22:53:59 +0900] [8915] [INFO] Using worker: sync
[2016-12-24 22:53:59 +0900] [8918] [INFO] Booting worker with pid: 8918
</pre></div></div>

<p>URLにリクエストを送信します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ curl http://127.0.0.1:8000/
</pre></div></div>

<p>pdb.set_trace()によってpdbが起動します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>&gt; /working/advent-calendar-2016-python/proj/urls.py(7)top_view()
-&gt; return HttpResponse('OK')
(Pdb)
</pre></div></div>

<p>先ほどのDjangoの開発サーバと同じです。</p>

<h3>
<span id="タイムアウトに気をつける" class="fragment"></span><a href="#%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%A2%E3%82%A6%E3%83%88%E3%81%AB%E6%B0%97%E3%82%92%E3%81%A4%E3%81%91%E3%82%8B"><i class="fa fa-link"></i></a>タイムアウトに気をつける</h3>

<p>Gunicornはリクエストをタイムアウトにする設定がありデフォルトで30秒です。pdbを起動してデバッグ中に <code>(Pdb) [2016-12-24 23:09:37 +0900] [9102] [CRITICAL] WORKER TIMEOUT (pid:9115)</code> を表示して<br>
pdbが終了してしまう場合はリクエストがタイムアウトとして扱われているので、<code>--timeout</code> でタイムアウトの値を大きく設定して実行します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ gunicorn proj.wsgi:application --timeout 9999999
[2016-12-24 23:13:11 +0900] [9126] [INFO] Starting gunicorn 19.6.0
[2016-12-24 23:13:11 +0900] [9126] [INFO] Listening at: http://127.0.0.1:8000 (9126)
[2016-12-24 23:13:11 +0900] [9126] [INFO] Using worker: sync
[2016-12-24 23:13:11 +0900] [9130] [INFO] Booting worker with pid: 9130
&gt; /working/advent-calendar-2016-python/proj/urls.py(7)top_view()
-&gt; return HttpResponse('OK')
(Pdb)
</pre></div></div>

<h2>
<span id="celeryでデバッガを使いたくなったら" class="fragment"></span><a href="#celery%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89"><i class="fa fa-link"></i></a>Celeryでデバッガを使いたくなったら</h2>

<p><a href="https://docs.celeryproject.org/" rel="nofollow noopener" target="_blank">Celery</a> はよく使われるタスクキューです。<br>
Brokerとして今回はRedisを使うので起動しておきます。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ nohup redis-server 2&gt;&amp;1 &gt; /dev/null &amp;
[1] 9384
</pre></div></div>

<p>tasks.pyを作成し、add()タスクを定義します。今回はこのadd()タスクをデバッグしたいとします。</p>

<p>tasks.py::</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>from celery import Celery

app = Celery('tasks', broker='pyamqp://guest@localhost//')

@app.task
def add(x, y):
    import pdb; pdb.set_trace()
    return x + y
</pre></div></div>

<p>workerを起動します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ celery -A tasks.app worker

 -------------- celery@ng-2.local v4.0.0 (latentcall)
---- **** -----
--- * ***  * -- Darwin-16.1.0-x86_64-i386-64bit 2016-12-24 23:23:27
-- * - **** ---
- ** ---------- [config]
- ** ---------- .&gt; app:         tasks:0x1042b4940
- ** ---------- .&gt; transport:   redis://127.0.0.1:6379//
- ** ---------- .&gt; results:     disabled://
- *** --- * --- .&gt; concurrency: 4 (prefork)
-- ******* ---- .&gt; task events: OFF (enable -E to monitor tasks in this worker)
--- ***** -----
 -------------- [queues]
                .&gt; celery           exchange=celery(direct) key=celery
</pre></div></div>

<p>別のターミナルでタスクを発火します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>&gt;&gt;&gt; import tasks
&gt;&gt;&gt; tasks.add.delay(1, 2)
&lt;AsyncResult: a07399f4-e28a-4471-b57d-30ce1cb3abf4&gt;
&gt;&gt;&gt;
</pre></div></div>

<p>workerを実行しているターミナルではbdb.BdbQuit例外が発生してしまいます。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>[2016-12-24 23:24:50,006: WARNING/PoolWorker-4] &gt; /working/advent-calendar-2016-python/tasks.py(9)add()
-&gt; return x + y
[2016-12-24 23:24:50,007: WARNING/PoolWorker-4] (Pdb)
[2016-12-24 23:24:50,061: ERROR/PoolWorker-4] Task tasks.add[a07399f4-e28a-4471-b57d-30ce1cb3abf4] raised unexpected: BdbQuit()
Traceback (most recent call last):
  File "/Users/sximada/ng2/var/lib/miniconda3/envs/py3.5.2/lib/python3.5/site-packages/celery/app/trace.py", line 368, in trace_task
    R = retval = fun(*args, **kwargs)
  File "/Users/sximada/ng2/var/lib/miniconda3/envs/py3.5.2/lib/python3.5/site-packages/celery/app/trace.py", line 623, in __protected_call__
    return self.run(*args, **kwargs)
  File "/working/advent-calendar-2016-python/tasks.py", line 9, in add
    return x + y
  File "/working/advent-calendar-2016-python/tasks.py", line 9, in add
    return x + y
  File "/Users/sximada/ng2/var/lib/miniconda3/envs/py3.5.2/lib/python3.5/bdb.py", line 48, in trace_dispatch
    return self.dispatch_line(frame)
  File "/Users/sximada/ng2/var/lib/miniconda3/envs/py3.5.2/lib/python3.5/bdb.py", line 67, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
</pre></div></div>

<p>実はCeleryのデバッグ方法は <a href="http://docs.celeryproject.org/en/latest/userguide/debugging.html" class="autolink" rel="nofollow noopener" target="_blank">http://docs.celeryproject.org/en/latest/userguide/debugging.html</a> に記載があります。<br>
pdbはそのまま使えず、 celery.contrib.rdbを使う必要があり、telnet経由でデバッガを使います。tasks.pyを修正します。</p>

<p>tasks.py::</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>from celery import Celery
from celery.contrib import rdb

app = Celery('tasks', broker='redis://127.0.0.1/')


@app.task
def add(x, y):
    rdb.set_trace()
    return x + y
</pre></div></div>

<p>タスクを再発火します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>&gt;&gt;&gt; import tasks
&gt;&gt;&gt; tasks.add.delay(1,2)
&lt;AsyncResult: 42b88871-a679-492f-bfc9-1f86043dab33&gt;
&gt;&gt;&gt;
</pre></div></div>

<p>するとworkerは <code>Remote Debugger:6900: Waiting for client...</code> というメッセージを表示します。<br>
このポート番号にtelnetでアクセスします。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ telnet 127.0.0.1 6900
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
&gt; /working/advent-calendar-2016-python/tasks.py(10)add()
-&gt; return x + y
(Pdb) p x
1
(Pdb) p y
2
(Pdb)
</pre></div></div>

<p>pdbが入力待ちしています。後はpdbの操作と同様です。<br>
タスクが終了するとworkerはポートを閉じます。<br>
複数回実行する場合は、その都度telnetで接続し直さなければなりません。</p>

<p>Celeryの場合はadd(1, 2)だと通常の関数実行になるので、それでデバッグしていくのも手です。<br>
ただそれでもCeleryのコードは実行されるので、タスクではない関数として実行できる状態にしておくと、<br>
Celeryの問題なのかの切り分けがしやすくなります。</p>

<h2>
<span id="jupyter-notebookでデバッガを使いたくなったら" class="fragment"></span><a href="#jupyter-notebook%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89"><i class="fa fa-link"></i></a>jupyter notebookでデバッガを使いたくなったら</h2>

<p>jupyter notebookには <code>%debug</code> マジックコマンドが提供されていて、これによりpdbを起動できます。<br>
以下は requests.get('<a href="http://example.com%27/" class="autolink" rel="nofollow noopener" target="_blank">http://example.com'</a>) をpdbでデバッグしています。</p>

<p><a href="https://qiita-image-store.s3.amazonaws.com/0/36261/3bf79b4a-ba00-3aa3-b165-422d0efff8b2.png" target="_blank" rel="nofollow noopener"><img src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/3bf79b4a-ba00-3aa3-b165-422d0efff8b2.png" alt="スクリーンショット 2016-12-25 0.05.23.png"></a></p>

<h2>
<span id="circleciでデバッガを使いたくなったら" class="fragment"></span><a href="#circleci%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89"><i class="fa fa-link"></i></a>CircleCIでデバッガを使いたくなったら</h2>

<p><a href="https://circleci.com/" rel="nofollow noopener" target="_blank">Circle CI</a> はよく使われるCIサービスです。<br>
<a href="https://circleci.com/" rel="nofollow noopener" target="_blank">Circle CI</a> 上で実行しているテストがエラーして、その原因が特定できないことがあります。<br>
その場合、<code>Rebuild with SSH</code> を選択してビルドすると、ビルドコンテナにSSHでログインし挙動を確認できます。</p>

<p><a href="https://qiita-image-store.s3.amazonaws.com/0/36261/ba41bf83-8e9d-73ee-b009-68c8d149d59d.png" target="_blank" rel="nofollow noopener"><img src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/ba41bf83-8e9d-73ee-b009-68c8d149d59d.png" alt="スクリーンショット 2016-12-24 22.20.56.png"></a></p>

<p>ホームディレクトリにリポジトリをcloneしているので、そこでコード内に <code>pdb.set_trace()</code> を仕込んで、<br>
手動でテストを実行することで、エラーの原因を特定しやすくなります。</p>

<h2>
<span id="staging環境でデバッガを使いたくなったら" class="fragment"></span><a href="#staging%E7%92%B0%E5%A2%83%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89"><i class="fa fa-link"></i></a>staging環境でデバッガを使いたくなったら</h2>

<p>これは別にPythonに限った話ではないのですが、sshでログインできるstaging環境がある場合、<br>
staging環境上でpdbを実行したくなりますよね。</p>

<p>例えばDjangoアプリケーションなら、<br>
staging上でpdb.set_trace()を記述して手動で開発サーバを適当なポート番号で起動し、<br>
ssh port forwardで開発サーバに繋げられるようにするのが手っ取り早いです。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>[staging]$ python manage.py runserver 4649
</pre></div></div>

<p>ssh port forwardでlocalhost:8000をstaging:4649に接続します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ ssh -L 8000:localhost:4649 staging
</pre></div></div>

<p>後はlocalhostでテストしているようにリクエストを送信します。</p>

<h2>
<span id="production環境でデバッガを使いたくなったら" class="fragment"></span><a href="#production%E7%92%B0%E5%A2%83%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89"><i class="fa fa-link"></i></a>production環境でデバッガを使いたくなったら</h2>

<p>絶対にやめましょう。事故ります(宣言)。<br>
RC環境があるならやってもいいかもしれませんが、<br>
それでも細心の注意を払わないと目も当てられないことになります。</p>
<div class="hidden"><form class="js-task-list-update" action="/TakesxiSximada/items/45b6d71a44f2706798ed" accept-charset="UTF-8" method="post"><input name="utf8" value="✓" type="hidden"><input name="_method" value="patch" type="hidden"><input name="authenticity_token" value="DsOMvTmcURwai36v3woZx8iR8Te1CdNBjxSWpPuwieqJPl2ssYq3JbqFWwFnr3ezRHebtHS2M/3PF9Gd+Z6o0w==" type="hidden"><input name="updated_at_confirmation_in_unixtime" id="updated_at_confirmation_in_unixtime" value="1486079906" class="js-task-list-updated-at" type="hidden"><textarea name="raw_body" id="raw_body" class="js-task-list-field">#
 PythonデバッグTips

この記事は [Python Advent Calendar 
2016](http://qiita.com/advent-calendar/2016/python) 
24日目の記事です。今回はPythonのデバッグのTipsをいくつか紹介します。

## print()でデバッグ

print()関数を使って確認したい値をstdoutに出力することでデバッグします。これで解決できるのであれば、それに越したことはありません。

FizzBuzzをデバッグします。今回は1から20までの数値を使ってFizzBuzzを出力したいとします。以下のコードには明らかなバグがありま
す。わかりますか?

example_fizzbuzz_buggy.py::

```
for ii in range(1, 21):
    if ii % 3 == 0:
        print('Fizz')
    elif ii % 5 == 0:
        print('Buzz')
    elif ii % 15 == 0:
        print('FizzBuzz')
    else:
        print(ii)

```

これを実行するとexample_fizzbuzz.pyは次のメッセージを表示します。

```
$ python example_fizzbuzz.py
1
2
Fizz
4
Buzz
Fizz
7
8
Fizz
Buzz
11
Fizz
13
14
Fizz
16
17
Fizz
19
Buzz
```

何かおかしいですね。`FizzBuzz` 
という表示が1個もありません。15の場合は`FizzBuzz`を表示するべきです。15の時の挙動を確認するためにprint()を追加してみます。

```
for ii in range(1, 21):
    print('CURRENT: {}'.format(ii))  # 追加
    if ii % 3 == 0:
        print('Fizz')
    elif ii % 5 == 0:
        print('Buzz')
    elif ii % 15 == 0:
        print('HIT')  # 追加
        print('FizzBuzz')
    else:
        print(ii)
```

`追加` とコメントした行が追加したprint()です。以下のデバッグメッセージを出力するためにコードを追加しました。

- 現在の数値を `CUURENT: 1` のように表示する
- 数値が15で割り切れた時 `HIT` と表示する

では実行します。

```
$ python  example_fizzbuzz.py
CURRENT: 1
1
CURRENT: 2
2
CURRENT: 3
Fizz
CURRENT: 4
4
CURRENT: 5
Buzz
CURRENT: 6
Fizz
CURRENT: 7
7
CURRENT: 8
8
CURRENT: 9
Fizz
CURRENT: 10
Buzz
CURRENT: 11
11
CURRENT: 12
Fizz
CURRENT: 13
13
CURRENT: 14
14
CURRENT: 15
Fizz
CURRENT: 16
16
CURRENT: 17
17
CURRENT: 18
Fizz
CURRENT: 19
19
CURRENT: 20
Buzz
```

`CURRENT: 15` の時は `Fizz` を表示していて、`HIT` は表示していません。ということは `if ii % 3 == 
0:` のブロックを実行しており `elif ii % 15 == 0:` のブロックは実行していないことがわかります。ii が 
15の場合は当然3で割り切れるので `if ii % 3 == 0:` はTrueになり、その後ろの `elif ii % 15 == 0:` が
 `elif` のため実行されていません。`ii % 15 == 0` 
は他の条件よりも先に分岐しなければならないことがわかったのでコードを直します。

```
$ python example_fizzbuzz.py
CURRENT: 1
1
CURRENT: 2
2
CURRENT: 3
Fizz
CURRENT: 4
4
CURRENT: 5
Buzz
CURRENT: 6
Fizz
CURRENT: 7
7
CURRENT: 8
8
CURRENT: 9
Fizz
CURRENT: 10
Buzz
CURRENT: 11
11
CURRENT: 12
Fizz
CURRENT: 13
13
CURRENT: 14
14
CURRENT: 15
HIT
FizzBuzz
CURRENT: 16
16
CURRENT: 17
17
CURRENT: 18
Fizz
CURRENT: 19
19
CURRENT: 20
Buzz
```

15の場合、`HIT` と `FizzBuzz` 
を表示しています。良さそうですね。バグが取り除かれました。あとは先ほど追加されたprint()を削除します。最終的なコードはこのようになります。

example_fizzbuzz.py::

```
for ii in range(1, 21):
    if ii % 15 == 0:
        print('FizzBuzz')
    elif ii % 3 == 0:
        print('Fizz')
    elif ii % 5 == 0:
        print('Buzz')
    else:
        print(ii)
```

この手法はどのプログラミング言語でもよく使われるものです。そして最後のprint()を削除し忘れるというのもよくやってしまいがちです。忘れず削除
するようにしましょう。

## pdbを使って1行ずつプログラムの動きを確認する

print()を使ってデバッグではデバッグメッセージをstdoutに出力することでプログラムがどのように動くかを確認しました。単純なプログラムで
あれば処理を追いかけられますが、複雑になってくるとデバッグメッセージだけでは動きがわかりにくくなります。[pdb]
(http://docs.python.jp/3/library/pdb.html) 
を使うとプログラムを1行ずつ確認しながら実行したり、その時の変数の値を確認できるため、よりプログラムの処理を追いかけやすくなります。

では先ほどの不具合入りの `example_fizzbuzz_buggy.py` をpdbを使って実行します。
pdbは標準ライブラリなのでpipでインストールする必要はありません。

```
$ python -m pdb example_fizzbuzz_buggy.py
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(1)&lt;module&gt;()
-&gt;
 for ii in range(1, 21):
(Pdb)
```

Pythonの引数に `-m pdb` 
を追加します。pdbで実行したスクリプトは最初に実行するコードで停止し、入力を待ちます。ここでpdbコマンドを指定してENTERを入力すること
で、デバッガを操作します。pdbコマンドの詳細は [27.3. pdb — Python デバッガー — Python 3.5.2 
ドキュメント](http://docs.python.jp/3/library/pdb.html#debugger-commands) 
で解説されています。

1行ずつ実行するには n (nextの意味) を入力します。

```
(Pdb) n
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt;
 if ii % 3 == 0:
(Pdb)
```

pdbは1行実行し、次に実行する行を表示しました。

この時表示された `&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()`
 は次のフォーマットをしています。

`&gt; ファイルパス(実行している行数)関数名()`

今回は関数にしていないので関数名の所は `&lt;module&gt;` 
という表示になっています。(実際には\_\_name\_\_の値を表示します)

ENTERだけ(コマンドの指定なし)の場合は、1個前のpdbコマンドを実行することになります。
そのためもう一行処理させたい場合は、ENTERを入力します。

```
(Pdb)
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(4)&lt;module&gt;()
-&gt;
 elif ii % 5 == 0:
(Pdb)
```

l (listの意味) を使うと現在どこの行を実行しているか確認できます。

```
(Pdb) l
  1     for ii in range(1, 21):
  2         if ii % 3 == 0:
  3             print('Fizz')
  4  -&gt;     elif ii % 5 == 0:
  5             print('Buzz')
  6         elif ii % 15 == 0:
  7             print('FizzBuzz')
  8         else:
  9             print(ii)
[EOF]
(Pdb)
```

`-&gt;` がマークされている行を次に実行します。
1行ずつではなく処理を進めたい場合は、c (continueの意味) を指定します。

```
(Pdb) c
1
2
Fizz
4
Buzz
Fizz
7
8
Fizz
Buzz
11
Fizz
13
14
Fizz
16
17
Fizz
19
Buzz
The program finished and will be restarted
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(1)&lt;module&gt;()
-&gt;
 for ii in range(1, 21):
```

プログラムを最後まで実行しました。最後までプログラムを処理するとpdbは `The program finished and will be 
restarted` を出力し、プログラムを再実行します。

行数を指定して処理を停止させたい場合、ブレイクポイントを使います。iiが15の時の処理を確認するため、b (breakの意味) 
コマンドを使ってif文で最初に分岐している2行目にブレイクポイントを設定します。

```
(Pdb) b 2
Breakpoint 1 at 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py:2
(Pdb)
```

これで2行目が処理される前にプログラムが一時停止します。cコマンドを使って処理を進めましょう。

```
(Pdb) c
1
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt;
 if ii % 3 == 0:
(Pdb)
```

停止しました。p (printの意味) コマンドを使ってiiの値が何かを確認します。

```
(Pdb) p ii
2
(Pdb)
```

2ですね。15の時の処理を確認したいので、cをあと13回実行しましょう。

```
(Pdb) c
2
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt;
 if ii % 3 == 0:
(Pdb) c
Fizz
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt;
 if ii % 3 == 0:
(Pdb) c
4
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt;
 if ii % 3 == 0:
(Pdb) c
Buzz
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt;
 if ii % 3 == 0:
(Pdb) c
Fizz
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt;
 if ii % 3 == 0:
(Pdb) c
7
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt;
 if ii % 3 == 0:
(Pdb) c
8
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt;
 if ii % 3 == 0:
(Pdb) c
Fizz
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt;
 if ii % 3 == 0:
(Pdb) c
Buzz
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt;
 if ii % 3 == 0:
(Pdb) c
11
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt;
 if ii % 3 == 0:
(Pdb) c
Fizz
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt;
 if ii % 3 == 0:
(Pdb) c
13
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt;
 if ii % 3 == 0:
(Pdb) c
14
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt;
 if ii % 3 == 0:
(Pdb) p ii
15
(Pdb)
```

上記ではcを何度も入力しましたが、停止する条件も設定できます。
今回はiiが15の時に停止して欲しいので、次のように条件を指定します。

```
(Pdb) b 2, ii == 15
Breakpoint 3 at 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py:2
(Pdb)
```

そしてcを実行するとiiが15の時だけ停止するので、cを何度も入力する必要はありません。

```
(Pdb) c
1
2
Fizz
4
Buzz
Fizz
7
8
Fizz
Buzz
11
Fizz
13
14
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(2)&lt;module&gt;()
-&gt;
 if ii % 3 == 0:
(Pdb) p ii
15
(Pdb)
```

あとはnで1行ずつ実行し動作を確認します。

```
(Pdb) n
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(3)&lt;module&gt;()
-&gt;
 print('Fizz')
(Pdb) n
Fizz
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(1)&lt;module&gt;()
-&gt;
 for ii in range(1, 21):
(Pdb)
```

3行目が実行されたあと1行目のfor文が処理される(つまり6行目の `elif ii % 15 == 0:` 
が処理されていない)ことがわかります。

```
(Pdb) list
  1  -&gt; for ii in range(1, 21):
  2 B       if ii % 3 == 0:
  3             print('Fizz')
  4         elif ii % 5 == 0:
  5             print('Buzz')
  6         elif ii % 15 == 0:
  7             print('FizzBuzz')
  8         else:
  9             print(ii)
[EOF]
(Pdb)
```

iiが15の時には `ii % 3 == 0` 
はTrueなので、このif-elif-elseでは15の時に正しく動作しないことをpdbを使って確認しました。

```
(Pdb) p ii
15
(Pdb) p ii % 3 == 0
True
(Pdb)
```

ブレイクポイントは cl (clearの意味) を使って削除します。

```
(Pdb) cl
Clear all breaks? yes
Deleted breakpoint 3 at 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py:2
(Pdb)
```

呼び出した関数の処理を確認するには、s (stepの意味) を指定します。

example_fizzbuzz_buggy2.py::

```
def fizzbuzz(num):
    if ii % 3 == 0:
        print('Fizz')
    elif ii % 5 == 0:
        print('Buzz')
    elif ii % 15 == 0:
        print('FizzBuzz')
    else:
        print(ii)

for ii in range(1, 21):
    fizzbuzz(ii)
```

example_fizzbuzz_buggy2.pyでfizzbuzz関数に入ってみます。


```
$ python -m pdb example_fizzbuzz_buggy2.py
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy2.py(1)&lt;module&gt;()
-&gt;
 def fizzbuzz(num):
(Pdb) n
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy2.py(11)&lt;module&gt;()
-&gt;
 for ii in range(1, 21):
(Pdb) n
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy2.py(12)&lt;module&gt;()
-&gt;
 fizzbuzz(ii)
(Pdb) p ii
1
```

ここまでは先ほど解説した内容を使って、12行目のfizzbuzz()呼び出しまで処理を進めています。

次にsを指定してfizzbuzz()の内部で処理を停止させています。

```
(Pdb) s
--Call--
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy2.py(1)fizzbuzz()
-&gt;
 def fizzbuzz(num):
(Pdb) n
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy2.py(2)fizzbuzz()
-&gt;
 if ii % 3 == 0:
(Pdb)
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy2.py(4)fizzbuzz()
-&gt;
 elif ii % 5 == 0:
```

fizzbuzz()の関数が終了したところまで処理を進めるには、r (returnの意味) を指定します。

```
(Pdb) r
1
--Return--
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy2.py(9)fizzbuzz()-&gt;None
-&gt;
 print(ii)
(Pdb) n
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy2.py(11)&lt;module&gt;()
-&gt;
 for ii in range(1, 21):
```

`fizzbuzz()-&gt;None` はfizzbuzz()がNoneを返したことを表しています。

### コード内に `import pdb; pdb.set_trace()` を記述する

pdbを使うために `python -m pdb` 
で実行していましたが、これでは起動のオプションを変更しなければなりません。これでは、起動スクリプトを作成していたりPythonを直接呼び出さない
場合にpdbを使えません。

pdbはそのためにset_trace()を提供しています。set_trace()が呼び出された時にpdbのデバッグモードに切り替わり、コマンドの
入力を待ちます。

example_fizzbuzz_buggy.pyにset_trace()を仕込みます。

example_fizzbuzz_buggy.py::

```
for ii in range(1, 21):
    if ii % 3 == 0:
        print('Fizz')
    elif ii % 5 == 0:
        import pdb; pdb.set_trace()  # 追加
        print('Buzz')
    elif ii % 15 == 0:
        print('FizzBuzz')
    else:
        print(ii)
```

5行目に `import pdb; pdb.set_trace()` を追加しました。
example_fizzbuzz_buggy.py実行しますが、今回は `-m pdb` は指定しません。

```
$ python  example_fizzbuzz_buggy.py
1
2
Fizz
4
&gt; 
/working/advent-calendar-2016-python/example_fizzbuzz_buggy.py(6)&lt;module&gt;()
-&gt;
 print('Buzz')
(Pdb)
```

6行目で停止しました。

```
(Pdb) l
  1     for ii in range(1, 21):
  2         if ii % 3 == 0:
  3             print('Fizz')
  4         elif ii % 5 == 0:
  5             import pdb; pdb.set_trace()
  6  -&gt;         print('Buzz')
  7         elif ii % 15 == 0:
  8             print('FizzBuzz')
  9         else:
 10             print(ii)
[EOF]
(Pdb)
```

set_trace()の次の行で処理が停止しています。
この方法を使えば起動オプションを変更することなくpdbを起動できます。

このデバッグコードはデバッグ終了時には必ず削除しなければなりません。
もし削除し忘れてしまった場合、本番の動作中にpdbが起動し入力待ちになるからです。
print()でのデバッグと違い、必ず実害が発生します。
GitのコミットフックやCIのテストでpdbの混入をチェックすることを勧めます。

`import pdb; pdb.set_trace()` は2つの文が指定されていて、片方はimport文です。
本来であればimport文はファイルの先頭に記述することが好まれますが、
このデバッグコードはデバッグ終了時には必ず消さなければならないため、
消す行を減らすために1行で記述しています。
Pythonの公式ドキュメントにもこのように紹介されており、
慣習的にもそれに習い1行で記述します。

## ipdbでデバッグ

ipdbはpdbの機能をIPythonを使って拡張したライブラリです。

ipdbはpipでインストールします。

```
$ pip install ipdb
```

`-m ipdb` をPythonの起動オプションに指定するか、`import ipdb; ipdb.set_trace()` 
をコード内に記述することで起動します。
コードハイライトされていて見やすいです。

![スクリーンショット 2016-12-24 
20.52.10.png](https://qiita-image-store.s3.amazonaws.com/0/36261
/c2a80285-a504-692e-3037-f7e6ddbd9c99.png)


タブを押すと属性一覧を表示できます。

![スクリーンショット 2016-12-24 
20.52.34.png](https://qiita-image-store.s3.amazonaws.com/0/36261
/a4c37b64-50fd-0d15-2c3a-069e8fe6884c.png)

その他、使用方法はpdbとほぼ同じです。

## bpdbでデバッグ

bpdbはpdbの機能をBPythonを使って拡張したライブラリです。
こちらはBPython自体の1機能として提供されています。

bpdbはpipでbpythonをインストールします。

```
$ pip install bpython
```

`-m bpdb` をPythonの起動オプションに指定するか、`import bpdb; bpdb.set_trace()` 
をコード内に記述することで起動します。
pdbと同様に動作しますが、`B` を入力すると現在のスタックフレームでBPythonが起動します。

![スクリーンショット 2016-12-24 
21.16.30.png](https://qiita-image-store.s3.amazonaws.com/0/36261
/b9413100-e2c8-551b-c192-059be3ba381d.png)

BPythonの終了は `C-d` です。

## pudbでデバッグ

[PuDB](https://mathema.tician.de/debug-python-in-style/) 
はコンソール上で使える高機能なデバッガです。

インストールします。

```
pip install pudb
```

インストールするとpudb3というコマンド(Python3の場合)が使えるようになります。
pudb3に実行したいファイルパスを指定することで起動します。

```
$ pudb3 example_fizzbuzz_buggy.py
```

デバッガのペインはpdbの操作と同じです。`C-x` でデバッガのペインとインタラクティブシェルのペインを行き来できます。

![スクリーンショット 2016-12-25 
0.15.41.png](https://qiita-image-store.s3.amazonaws.com/0/36261
/b60e9474-debb-cb2f-2377-0c180702141b.png)


テーマなどを設定でき、設定値は~/.config/pudb/pudb.cfgに保存しています。

~/.config/pudb/pudb.cfg::

```
[pudb]
breakpoints_weight = 1
current_stack_frame = top
custom_stringifier =
custom_theme =
display = auto
line_numbers = True
prompt_on_quit = True
seen_welcome = e027
shell = classic
sidebar_width = 0.5
stack_weight = 1
stringifier = type
theme = dark vim
variables_weight = 1
wrap_variables = True
```

## PyCharmでデバッグ

[PyCharm](https://www.jetbrains.com/pycharm) 
はJetBrains社が開発したPythonのIDEです。GUI操作でデバッガを操作できます。とても直感的に操作することができ素晴らしいです。イ
ンストーラは https://www.jetbrains.com/pycharm/download/ からダウンロードできます。

ファイルを開き、ブレイクポイントを設定してみます。

![スクリーンショット 2016-12-25 
0.37.53.png](https://qiita-image-store.s3.amazonaws.com/0/36261
/31a5a886-5c37-7ca9-1718-88c38fed7498.png)


行番号表示の右側をクリックすると赤丸が出現します。これがデバッガです。VSとかEclipseとかと同じですね。

実行はメニューから [Run] &gt; [Debug]、 (もしくは虫マーク
)をクリックします。

![スクリーンショット 2016-12-25 
0.41.05.png](https://qiita-image-store.s3.amazonaws.com/0/36261
/bb58c79b-ea17-37f2-79a6-f77a4cd28052.png)

虫マーク

![スクリーンショット 2016-12-25 
0.41.26.png](https://qiita-image-store.s3.amazonaws.com/0/36261
/60033b9a-7aeb-97aa-143b-222e9b9b7a83.png)


実行するとブレイクポイントで止まり、スタックフレームや変数がペインに表示されます。

![スクリーンショット 2016-12-25 
0.38.40.png](https://qiita-image-store.s3.amazonaws.com/0/36261
/f58ba432-f7ed-ceab-d989-62e69aa5874d.png)



細かい操作はアイコンが有効になるのでそれをクリックすれば操作できるし、マウスオーバーすれば何を行うアイコンかを表示します。


![スクリーンショット 2016-12-25 
0.42.37.png](https://qiita-image-store.s3.amazonaws.com/0/36261
/e726f6af-4732-7e71-bbb1-0e662a23d4f6.png)


またProfessional Editionではリモートデバッグ機能が使えます。

## いろんなシーンでデバッグする

## unittestでデバッガを使いたくなったら

unittestでエラーになるけど原因がわからない場合、testコードでデバッグしたくなります。
その場合はテストコード内に `pdb.set_trace()` を仕込み、pdbを起動できます。

例えば以下のテストコードでテスト実行時にpdbを起動します。

test_main.py::

```
from unittest import TestCase


def create_message(count):
    return 'Fish: {}'.format(count)


class SimpleTest(TestCase):
    def test_it(self):
        import pdb; pdb.set_trace()  # デバッグコード
        msg = create_message(1)
        self.assertEqual(msg, 'Fish: 1')
```

unittestを実行するとpdbが起動します。

```
$ python -m unittest
&gt; /working/advent-calendar-2016-python/test_main.py(11)test_it()
-&gt; msg = create_message(1)
(Pdb) list
  6
  7
  8     class SimpleTest(TestCase):
  9         def test_it(self):
 10             import pdb; pdb.set_trace()  # デバッグコード
 11  -&gt;         msg = create_message(1)
 12             self.assertEqual(msg, 'Fish: 1')
[EOF]
(Pdb)
```

## noseでデバッガを使いたくなったら

[nose](https://nose.readthedocs.io/en/latest/) はよく使われるテストフレームワークです。
先ほどのようにテストを途中でpdbを使って停止させる場合、`--nocapture` を指定します。

```
$ nosetests --nocapture
&gt; /working/advent-calendar-2016-python/test_main.py(11)test_it()
-&gt; msg = create_message(1)
(Pdb)
```

またエラーや失敗した時にpdbを起動するための `--pdb`、 `--pdb-failures`、`--pdb-errors` 
も提供されています。

```
$ nosetests --pdb
&gt; 
/Users/sximada/ng2/var/lib/miniconda3/envs/py3.5.2/lib/python3.5/unittest/case.py(665)fail()
-&gt;
 raise self.failureException(msg)
(Pdb)
```

noseのドキュメントには `Warning nose itself supports python 3, but many 3rd-party
 plugins do not!` と記述がある通り、
nose自体ではなく、noseのpluginのPython3対応が進んでいないようです。

## pytestでデバッガを使いたくなったら

[pytest](http://docs.pytest.org/en/latest/) もnose同様よく使われるテストフレームワークです。
[pytest](http://docs.pytest.org/en/latest/) 
はそのまま実行すれば、set_trace()実行時にpdbが起動します。

```
$ pytest
================================================================================
 test session starts 
================================================================================
platform
 darwin -- Python 3.5.2, pytest-3.0.5, py-1.4.32, pluggy-0.4.0
rootdir: /working/advent-calendar-2016-python, inifile:
plugins: celery-4.0.0
collected 1 items

test_main.py
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
 PDB set_trace (IO-capturing turned off) 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;
 /working/advent-calendar-2016-python/test_main.py(11)test_it()
-&gt; msg = create_message(1)
(Pdb)
```

`--pdb` を指定することでエラー時にデバッガを起動できます。

```
$ pytest --pdb
================================================================================
 test session starts 
================================================================================
platform
 darwin -- Python 3.5.2, pytest-3.0.5, py-1.4.32, pluggy-0.4.0
rootdir: /working/advent-calendar-2016-python, inifile:
plugins: celery-4.0.0
collected 2 items

test_main.py F
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
 traceback 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;

self
 = &lt;test_main.SimpleTest testMethod=test_error&gt;

    def test_error(self):
        msg = create_message(1)
&gt;       self.assertEqual(msg, 'ERROR')
E       AssertionError: 'Fish: 1' != 'ERROR'
E       - Fish: 1
E       + ERROR

test_main.py:15: AssertionError
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
 entering PDB 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;
 
/Users/sximada/ng2/var/lib/miniconda3/envs/py3.5.2/lib/python3.5/unittest/case.py(665)fail()
-&gt;
 raise self.failureException(msg)
(Pdb)
```

## Djangoでデバッガを使いたくなったら

[Django](https://www.djangoproject.com/) はよく使われるウェブフレームワークです。
[Django](https://www.djangoproject.com/) でpdbを使うことは
開発サーバ(`manage.py runserver`)であれば何も難しくありません。

プロジェクトを作成してpdbを起動してみます。

プロジェクトの構成は以下の通りです。

```
$ tree proj
proj
├── __init__.py
├── settings.py
├── urls.py
└── wsgi.py
```

proj/urls.pyは次のように記述します。


```
from django.conf.urls import url
from django.http import HttpResponse


def top_view(request):
    import pdb; pdb.set_trace()
    return HttpResponse('OK')

urlpatterns = [
    url(r'^$', top_view),
]
```

`/` にアクセスすると`OK`とリクエストを返すViewを定義しています。
(ファイルを分割するのが面倒だったのでviewもurls.pyに記述しています)
View関数内にはpdb.set_trac()を記述しています。

runserverで開発サーバを起動します。

```
$ python manage.py runserver
Performing system checks...

System check identified no issues (0 silenced).
December 24, 2016 - 13:45:26
Django version 1.11.dev20161224024349, using settings 'proj.settings'
Starting development server at http://127.0.0.1:8000/
Quit the server with CONTROL-C.
```

URLにリクエストを送信します。

```
$ curl http://127.0.0.1:8000/
```

開発サーバはpdb.set_trace()によってpdbを起動し入力を待ちます。

```
&gt; /working/advent-calendar-2016-python/proj/urls.py(7)top_view()
-&gt; return HttpResponse('OK')
(Pdb)
```

後はデバッグするだけです。リクエストオブジェクトの中身を確認も確認できます。他のWAFも同様にpdbでデバッグできることが多いです。

## gunicornでデバッガを使いたくなったら

[gunicorn](http://gunicorn.org/) はよく使われるWSGI HTTP Serverです。
先ほどのDjango Projectを [gunicorn](http://gunicorn.org/) で実行します。

```
$ gunicorn proj.wsgi:application
[2016-12-24 22:53:59 +0900] [8915] [INFO] Starting gunicorn 19.6.0
[2016-12-24 22:53:59 +0900] [8915] [INFO] Listening at: 
http://127.0.0.1:8000 (8915)
[2016-12-24 22:53:59 +0900] [8915] [INFO] Using worker: sync
[2016-12-24 22:53:59 +0900] [8918] [INFO] Booting worker with pid: 8918
```

URLにリクエストを送信します。

```
$ curl http://127.0.0.1:8000/
```

pdb.set_trace()によってpdbが起動します。

```
&gt; /working/advent-calendar-2016-python/proj/urls.py(7)top_view()
-&gt; return HttpResponse('OK')
(Pdb)
```

先ほどのDjangoの開発サーバと同じです。

### タイムアウトに気をつける

Gunicornはリクエストをタイムアウトにする設定がありデフォルトで30秒です。pdbを起動してデバッグ中に `(Pdb) 
[2016-12-24 23:09:37 +0900] [9102] [CRITICAL] WORKER TIMEOUT (pid:9115)`
 を表示して
pdbが終了してしまう場合はリクエストがタイムアウトとして扱われているので、`--timeout` 
でタイムアウトの値を大きく設定して実行します。

```
$ gunicorn proj.wsgi:application --timeout 9999999
[2016-12-24 23:13:11 +0900] [9126] [INFO] Starting gunicorn 19.6.0
[2016-12-24 23:13:11 +0900] [9126] [INFO] Listening at: 
http://127.0.0.1:8000 (9126)
[2016-12-24 23:13:11 +0900] [9126] [INFO] Using worker: sync
[2016-12-24 23:13:11 +0900] [9130] [INFO] Booting worker with pid: 9130
&gt; /working/advent-calendar-2016-python/proj/urls.py(7)top_view()
-&gt; return HttpResponse('OK')
(Pdb)
```

## Celeryでデバッガを使いたくなったら

[Celery](https://docs.celeryproject.org) はよく使われるタスクキューです。
Brokerとして今回はRedisを使うので起動しておきます。

```
$ nohup redis-server 2&gt;&amp;1 &gt; /dev/null &amp;
[1] 9384
```

tasks.pyを作成し、add()タスクを定義します。今回はこのadd()タスクをデバッグしたいとします。


tasks.py::

```
from celery import Celery

app = Celery('tasks', broker='pyamqp://guest@localhost//')

@app.task
def add(x, y):
    import pdb; pdb.set_trace()
    return x + y
```

workerを起動します。

```
$ celery -A tasks.app worker

 -------------- celery@ng-2.local v4.0.0 (latentcall)
---- **** -----
--- * ***  * -- Darwin-16.1.0-x86_64-i386-64bit 2016-12-24 23:23:27
-- * - **** ---
- ** ---------- [config]
- ** ---------- .&gt; app:         tasks:0x1042b4940
- ** ---------- .&gt; transport:   redis://127.0.0.1:6379//
- ** ---------- .&gt; results:     disabled://
- *** --- * --- .&gt; concurrency: 4 (prefork)
-- ******* ---- .&gt; task events: OFF (enable -E to monitor tasks in 
this worker)
--- ***** -----
 -------------- [queues]
                .&gt; celery           exchange=celery(direct) 
key=celery
```

 別のターミナルでタスクを発火します。

```
&gt;&gt;&gt; import tasks
&gt;&gt;&gt; tasks.add.delay(1, 2)
&lt;AsyncResult: a07399f4-e28a-4471-b57d-30ce1cb3abf4&gt;
&gt;&gt;&gt;
```

workerを実行しているターミナルではbdb.BdbQuit例外が発生してしまいます。

```
[2016-12-24 23:24:50,006: WARNING/PoolWorker-4] &gt; 
/working/advent-calendar-2016-python/tasks.py(9)add()
-&gt; return x + y
[2016-12-24 23:24:50,007: WARNING/PoolWorker-4] (Pdb)
[2016-12-24 23:24:50,061: ERROR/PoolWorker-4] Task 
tasks.add[a07399f4-e28a-4471-b57d-30ce1cb3abf4] raised unexpected: 
BdbQuit()
Traceback (most recent call last):
  File 
"/Users/sximada/ng2/var/lib/miniconda3/envs/py3.5.2/lib/python3.5/site-packages/celery/app/trace.py",
 line 368, in trace_task
    R = retval = fun(*args, **kwargs)
  File 
"/Users/sximada/ng2/var/lib/miniconda3/envs/py3.5.2/lib/python3.5/site-packages/celery/app/trace.py",
 line 623, in __protected_call__
    return self.run(*args, **kwargs)
  File "/working/advent-calendar-2016-python/tasks.py", line 9, in add
    return x + y
  File "/working/advent-calendar-2016-python/tasks.py", line 9, in add
    return x + y
  File 
"/Users/sximada/ng2/var/lib/miniconda3/envs/py3.5.2/lib/python3.5/bdb.py",
 line 48, in trace_dispatch
    return self.dispatch_line(frame)
  File 
"/Users/sximada/ng2/var/lib/miniconda3/envs/py3.5.2/lib/python3.5/bdb.py",
 line 67, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
```

実はCeleryのデバッグ方法は 
http://docs.celeryproject.org/en/latest/userguide/debugging.html 
に記載があります。
pdbはそのまま使えず、 
celery.contrib.rdbを使う必要があり、telnet経由でデバッガを使います。tasks.pyを修正します。

tasks.py::

```
from celery import Celery
from celery.contrib import rdb

app = Celery('tasks', broker='redis://127.0.0.1/')


@app.task
def add(x, y):
    rdb.set_trace()
    return x + y
```

タスクを再発火します。

```
&gt;&gt;&gt; import tasks
&gt;&gt;&gt; tasks.add.delay(1,2)
&lt;AsyncResult: 42b88871-a679-492f-bfc9-1f86043dab33&gt;
&gt;&gt;&gt;
```

するとworkerは `Remote Debugger:6900: Waiting for client...` というメッセージを表示します。
このポート番号にtelnetでアクセスします。

```
$ telnet 127.0.0.1 6900
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
&gt; /working/advent-calendar-2016-python/tasks.py(10)add()
-&gt; return x + y
(Pdb) p x
1
(Pdb) p y
2
(Pdb)
```

pdbが入力待ちしています。後はpdbの操作と同様です。
タスクが終了するとworkerはポートを閉じます。
複数回実行する場合は、その都度telnetで接続し直さなければなりません。

Celeryの場合はadd(1, 2)だと通常の関数実行になるので、それでデバッグしていくのも手です。
ただそれでもCeleryのコードは実行されるので、タスクではない関数として実行できる状態にしておくと、
Celeryの問題なのかの切り分けがしやすくなります。

## jupyter notebookでデバッガを使いたくなったら

jupyter notebookには `%debug` マジックコマンドが提供されていて、これによりpdbを起動できます。
以下は requests.get('http://example.com') をpdbでデバッグしています。

![スクリーンショット 2016-12-25 
0.05.23.png](https://qiita-image-store.s3.amazonaws.com/0/36261/3bf79b4a-ba00-3aa3-b165-422d0efff8b2.png)

##
 CircleCIでデバッガを使いたくなったら

[Circle CI](https://circleci.com/) はよく使われるCIサービスです。
[Circle CI](https://circleci.com/) 上で実行しているテストがエラーして、その原因が特定できないことがあります。
その場合、`Rebuild with SSH` を選択してビルドすると、ビルドコンテナにSSHでログインし挙動を確認できます。

![スクリーンショット 2016-12-24 
22.20.56.png](https://qiita-image-store.s3.amazonaws.com/0/36261
/ba41bf83-8e9d-73ee-b009-68c8d149d59d.png)


ホームディレクトリにリポジトリをcloneしているので、そこでコード内に `pdb.set_trace()` を仕込んで、
手動でテストを実行することで、エラーの原因を特定しやすくなります。

## staging環境でデバッガを使いたくなったら

これは別にPythonに限った話ではないのですが、sshでログインできるstaging環境がある場合、
staging環境上でpdbを実行したくなりますよね。

例えばDjangoアプリケーションなら、
staging上でpdb.set_trace()を記述して手動で開発サーバを適当なポート番号で起動し、
ssh port forwardで開発サーバに繋げられるようにするのが手っ取り早いです。

```
[staging]$ python manage.py runserver 4649
```

ssh port forwardでlocalhost:8000をstaging:4649に接続します。

```
$ ssh -L 8000:localhost:4649 staging
```

後はlocalhostでテストしているようにリクエストを送信します。

## production環境でデバッガを使いたくなったら

絶対にやめましょう。事故ります(宣言)。
RC環境があるならやってもいいかもしれませんが、
それでも細心の注意を払わないと目も当てられないことになります。

</textarea><input name="commit" value="Save changes" data-disable-with="Save changes" type="submit"></form></div></section><div style="text-align: center;"><div style="display: inline-block; margin: 10px auto;"><div style="height: 280px; width: 336px;" id="dfp-slot-between-body-and-comments-for-mobile"><div style="border: 0pt none;" id="google_ads_iframe_/383564218/qiita.com_items-show_under-article-mobile_0__container__"><iframe srcdoc="" style="border: 0px none; vertical-align: bottom;" marginheight="0" marginwidth="0" scrolling="no" name="google_ads_iframe_/383564218/qiita.com_items-show_under-article-mobile_0" title="3rd party ad content" id="google_ads_iframe_/383564218/qiita.com_items-show_under-article-mobile_0" frameborder="0" height="280" width="336"></iframe></div></div></div></div></div><div class="col-sm-3"><div style="width: 300px; height: 250px; margin-bottom: 20px;" id="dfp-slot-sidebar-top"><div style="border: 0pt none;" id="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-top_0__container__"><iframe srcdoc="" style="border: 0px none; vertical-align: bottom;" marginheight="0" marginwidth="0" scrolling="no" name="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-top_0" title="3rd party ad content" id="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-top_0" frameborder="0" height="250" width="300"></iframe></div></div><div class="socialButtons"><div class="socialButtons_twitter"><iframe data-url="http://qiita.com/TakesxiSximada/items/45b6d71a44f2706798ed" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/tweet_button.html" title="Twitter Tweet Button" style="position: static; visibility: visible; width: 60px; height: 20px;" class="twitter-share-button twitter-share-button-rendered twitter-tweet-button" allowtransparency="true" scrolling="no" id="twitter-widget-0" frameborder="0"></iframe></div><div class="socialButtons_hatebu"><iframe style="width: 47px; height: 20px;" src="javascript:false" scrolling="no" title="Add to Hatena Bookmark" class="hatena-bookmark-button-frame" frameborder="0" height="20" width="47"></iframe><script async="async" charset="utf-8" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/bookmark_button.js" type="text/javascript"></script></div><div class="socialButtons_googlePlus"><div id="___plusone_0" style="text-indent: 0px; margin: 0px; padding: 0px; background: transparent none repeat scroll 0% 0%; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; display: inline-block; width: 32px; height: 20px;"><iframe title="G+" data-gapiattached="true" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/fastbutton.html" name="I0_1502057979635" id="I0_1502057979635" vspace="0" tabindex="0" style="position: static; top: 0px; width: 32px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 20px;" scrolling="no" marginwidth="0" marginheight="0" hspace="0" ng-non-bindable="" frameborder="0" width="100%"></iframe></div></div><div class="socialButtons_facebook"><div fb-iframe-plugin-query="action=like&amp;app_id=222621691108322&amp;container_width=0&amp;href=http%3A%2F%2Fqiita.com%2FTakesxiSximada%2Fitems%2F45b6d71a44f2706798ed&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey&amp;share=false&amp;show_faces=false" fb-xfbml-state="parsed" class="fb-like fb_iframe_widget" data-action="like" data-href="http://qiita.com/TakesxiSximada/items/45b6d71a44f2706798ed" data-layout="button_count" data-share="false" data-show-faces="false"><span style="vertical-align: top; width: 0px; height: 0px; overflow: hidden;"><iframe src="https://www.facebook.com/plugins/like.php?action=like&amp;app_id=222621691108322&amp;channel=http%3A%2F%2Fstaticxx.facebook.com%2Fconnect%2Fxd_arbiter%2Fr%2FXBwzv5Yrm_1.js%3Fversion%3D42%23cb%3Df6b48406e9f21c%26domain%3Dqiita.com%26origin%3Dhttp%253A%252F%252Fqiita.com%252Ff34285751f604b8%26relation%3Dparent.parent&amp;container_width=0&amp;href=http%3A%2F%2Fqiita.com%2FTakesxiSximada%2Fitems%2F45b6d71a44f2706798ed&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey&amp;share=false&amp;show_faces=false" style="border: medium none; visibility: hidden;" title="fb:like Facebook Social Plugin" scrolling="no" allowfullscreen="true" allowtransparency="true" name="f3f817fc357258e" frameborder="0" height="1000px" width="1000px"></iframe></span></div></div><div class="socialButtons_pocket"><div class="pocket-btn"><iframe id="pocket-button-0" allowtransparency="true" scrolling="NO" src="https://widgets.getpocket.com/v1/button?label=pocket&amp;count=horizontal&amp;v=1&amp;url=http%3A%2F%2Fqiita.com%2FTakesxiSximada%2Fitems%2F45b6d71a44f2706798ed&amp;title=Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita&amp;src=http%3A%2F%2Fqiita.com%2FTakesxiSximada%2Fitems%2F45b6d71a44f2706798ed&amp;r=0.07081999221649349" frameborder="0" height="22" width="135"></iframe></div></div></div><section class="itemsShowAuthorInfo" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><a href="http://qiita.com/TakesxiSximada"><img alt="" class="itemsShowAuthorInfo_userIcon" itemprop="image" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473687011.png"></a><div class="itemsShowAuthorInfo_profileStats"><strong class="itemsShowAuthorInfo_userName" itemprop="name"><a itemprop="url" href="http://qiita.com/TakesxiSximada">TakesxiSximada</a></strong><div class="itemsShowAuthorInfo_contribution"><span class="itemsShowAuthorInfo_count">394</span><span class="itemsShowAuthorInfo_unit">Contribution</span></div><script type="application/json" id="js-react-on-rails-context">{}</script>
<script type="application/json" class="js-react-on-rails-component" data-component-name="UserFollowButton" data-dom-id="UserFollowButton-react-component-a4b83633-c26d-43c9-93be-3d1cd1aceb75">{"initial_followed_by":false,"position":"author-info","size":"btn-xs","url_name":"TakesxiSximada"}</script>
    <div id="UserFollowButton-react-component-a4b83633-c26d-43c9-93be-3d1cd1aceb75"><span class="userFollowButton" data-reactroot=""><button class="btn btn-default btn-block userFollowButton_inner btn-xs"><i class="i fa fa-user-plus"></i><!-- react-text: 4 -->Follow<!-- /react-text --></button></span></div>
    
</div><section class="itemsShowAuthorPopularItems"><h5 class="itemsShowAuthorPopularItems_sectionTitle">人気の投稿</h5><ul class="itemsShowAuthorPopularItems_posts list-unstyled"><li itemscope="" itemtype="http://schema.org/Article"> <a itemprop="url" track="click" data-label="AuthorPopularItemsAtSidebar" href="http://qiita.com/TakesxiSximada/items/dedd81f1da4379f3006e">Selenium Web DriverのPythonバインディングを使ってブラウザを操作する</a></li><li itemscope="" itemtype="http://schema.org/Article"> <a itemprop="url" track="click" data-label="AuthorPopularItemsAtSidebar" href="http://qiita.com/TakesxiSximada/items/45b6d71a44f2706798ed">PythonデバッグTips</a></li><li itemscope="" itemtype="http://schema.org/Article"> <a itemprop="url" track="click" data-label="AuthorPopularItemsAtSidebar" href="http://qiita.com/TakesxiSximada/items/65f8c018d25c6b08df85">Python言語入門</a></li><li itemscope="" itemtype="http://schema.org/Article"> <a itemprop="url" track="click" data-label="AuthorPopularItemsAtSidebar" href="http://qiita.com/TakesxiSximada/items/0944d989e72fa8ac8f3a">Pythonスクレイピングメモ</a></li><li itemscope="" itemtype="http://schema.org/Article"> <a itemprop="url" track="click" data-label="AuthorPopularItemsAtSidebar" href="http://qiita.com/TakesxiSximada/items/a482d78eaa0c854e8a9b">IBM Watson Developer Cloud Visual Recognition で物体認識させる</a></li></ul></section></section><div class="scroll-chaser"><div style="width: 300px; height: 250px; margin-top: 10px; margin-bottom: 30px;" id="dfp-slot-sidebar-bottom"><div style="border: 0pt none;" id="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-bottom_0__container__"><iframe srcdoc="" style="border: 0px none; vertical-align: bottom;" marginheight="0" marginwidth="0" scrolling="no" name="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-bottom_0" title="3rd party ad content" id="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-bottom_0" frameborder="0" height="250" width="300"></iframe></div></div></div><script type="application/json" class="js-react-on-rails-component" data-component-name="Toc" data-dom-id="Toc-react-component-7831c14e-8011-486a-886b-e482a138c269">{"body":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0tips\"\u003ePythonデバッグTips\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#print%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%B0\"\u003eprint()でデバッグ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#pdb%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A61%E8%A1%8C%E3%81%9A%E3%81%A4%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%AE%E5%8B%95%E3%81%8D%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B\"\u003epdbを使って1行ずつプログラムの動きを確認する\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E5%86%85%E3%81%AB-import-pdb-pdbset_trace-%E3%82%92%E8%A8%98%E8%BF%B0%E3%81%99%E3%82%8B\"\u003eコード内に \u003ccode\u003eimport pdb; pdb.set_trace()\u003c/code\u003e を記述する\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#ipdb%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%B0\"\u003eipdbでデバッグ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#bpdb%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%B0\"\u003ebpdbでデバッグ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#pudb%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%B0\"\u003epudbでデバッグ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#pycharm%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%B0\"\u003ePyCharmでデバッグ\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%84%E3%82%8D%E3%82%93%E3%81%AA%E3%82%B7%E3%83%BC%E3%83%B3%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%B0%E3%81%99%E3%82%8B\"\u003eいろんなシーンでデバッグする\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#unittest%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89\"\u003eunittestでデバッガを使いたくなったら\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#nose%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89\"\u003enoseでデバッガを使いたくなったら\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#pytest%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89\"\u003epytestでデバッガを使いたくなったら\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#django%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89\"\u003eDjangoでデバッガを使いたくなったら\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#gunicorn%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89\"\u003egunicornでデバッガを使いたくなったら\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%A2%E3%82%A6%E3%83%88%E3%81%AB%E6%B0%97%E3%82%92%E3%81%A4%E3%81%91%E3%82%8B\"\u003eタイムアウトに気をつける\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#celery%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89\"\u003eCeleryでデバッガを使いたくなったら\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#jupyter-notebook%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89\"\u003ejupyter notebookでデバッガを使いたくなったら\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#circleci%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89\"\u003eCircleCIでデバッガを使いたくなったら\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#staging%E7%92%B0%E5%A2%83%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89\"\u003estaging環境でデバッガを使いたくなったら\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#production%E7%92%B0%E5%A2%83%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89\"\u003eproduction環境でデバッガを使いたくなったら\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","wrapper":"#article-body-wrapper"}</script>
    <div id="Toc-react-component-7831c14e-8011-486a-886b-e482a138c269"><div style="position: relative; top: 0px; height: 0px;"></div><div style="width: 165px; position: fixed; top: 0px;" class="tocTree" data-reactroot=""><div style="max-height: 905px;" class="tocTree_contents nav"><ul>
<li class="active">
<a href="#python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0tips">PythonデバッグTips</a>
<ul>
<li>
<a href="#print%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%B0">print()でデバッグ</a>
</li>
<li>
<a href="#pdb%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A61%E8%A1%8C%E3%81%9A%E3%81%A4%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%AE%E5%8B%95%E3%81%8D%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B">pdbを使って1行ずつプログラムの動きを確認する</a>
<ul>
<li>
<a href="#%E3%82%B3%E3%83%BC%E3%83%89%E5%86%85%E3%81%AB-import-pdb-pdbset_trace-%E3%82%92%E8%A8%98%E8%BF%B0%E3%81%99%E3%82%8B">コード内に <code>import pdb; pdb.set_trace()</code> を記述する</a>
</li>
</ul>
</li>
<li>
<a href="#ipdb%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%B0">ipdbでデバッグ</a>
</li>
<li>
<a href="#bpdb%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%B0">bpdbでデバッグ</a>
</li>
<li>
<a href="#pudb%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%B0">pudbでデバッグ</a>
</li>
<li>
<a href="#pycharm%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%B0">PyCharmでデバッグ</a>
</li>
<li>
<a href="#%E3%81%84%E3%82%8D%E3%82%93%E3%81%AA%E3%82%B7%E3%83%BC%E3%83%B3%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%B0%E3%81%99%E3%82%8B">いろんなシーンでデバッグする</a>
</li>
<li>
<a href="#unittest%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89">unittestでデバッガを使いたくなったら</a>
</li>
<li>
<a href="#nose%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89">noseでデバッガを使いたくなったら</a>
</li>
<li>
<a href="#pytest%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89">pytestでデバッガを使いたくなったら</a>
</li>
<li class="active">
<a href="#django%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89">Djangoでデバッガを使いたくなったら</a>
</li>
<li>
<a href="#gunicorn%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89">gunicornでデバッガを使いたくなったら</a>
<ul>
<li>
<a href="#%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%A2%E3%82%A6%E3%83%88%E3%81%AB%E6%B0%97%E3%82%92%E3%81%A4%E3%81%91%E3%82%8B">タイムアウトに気をつける</a>
</li>
</ul>
</li>
<li>
<a href="#celery%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89">Celeryでデバッガを使いたくなったら</a>
</li>
<li>
<a href="#jupyter-notebook%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89">jupyter notebookでデバッガを使いたくなったら</a>
</li>
<li>
<a href="#circleci%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89">CircleCIでデバッガを使いたくなったら</a>
</li>
<li>
<a href="#staging%E7%92%B0%E5%A2%83%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89">staging環境でデバッガを使いたくなったら</a>
</li>
<li>
<a href="#production%E7%92%B0%E5%A2%83%E3%81%A7%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%89">production環境でデバッガを使いたくなったら</a>
</li>
</ul>
</li>
</ul>
</div></div></div>
    
</div></div><div class="row"><div class="col-sm-9"><div class="ArticleFooter__menu"><div class="s-flex-align-center"><div class="js-likebutton" data-props="{&quot;like_status&quot;:false,&quot;like_count&quot;:61,&quot;show_count&quot;:true,&quot;uuid&quot;:&quot;45b6d71a44f2706798ed&quot;,&quot;likable_type&quot;:&quot;Article&quot;,&quot;position&quot;:&quot;article-footer&quot;}"><div class="LikeButton" data-reactroot=""><button class="p-button"><span class="fa fa-fw fa-thumbs-up"></span><span>Like</span></button><div class="LikeButton__balloon">61</div></div></div><div class="ArticleFooter__userList"><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="massa142"><a itemprop="url" href="http://qiita.com/massa142"><img alt="massa142" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473682619.jpeg"></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="sharow"><a itemprop="url" href="http://qiita.com/sharow"><img alt="sharow" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1498989659.png"></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="zaoriku0"><a itemprop="url" href="http://qiita.com/zaoriku0"><img alt="zaoriku0" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473684178.jpeg"></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="kochory"><a itemprop="url" href="http://qiita.com/kochory"><img alt="kochory" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473697785.jpeg"></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="matsulib"><a itemprop="url" href="http://qiita.com/matsulib"><img alt="matsulib" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/04h61MUk_normal.png"></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="GushiSnow"><a itemprop="url" href="http://qiita.com/GushiSnow"><img alt="GushiSnow" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473757289.jpeg"></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="shspage"><a itemprop="url" href="http://qiita.com/shspage"><img alt="shspage" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473681713.png"></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="driller"><a itemprop="url" href="http://qiita.com/driller"><img alt="driller" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1477644793.png"></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="aki_yok"><a itemprop="url" href="http://qiita.com/aki_yok"><img alt="aki_yok" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473682400.png"></a></div></div><div class="ArticleFooter__user"><div class="js-hovercard" data-hovercard-target-name="neka-nat@github"><a itemprop="url" href="http://qiita.com/neka-nat@github"><img alt="neka-nat@github" class="thumb thumb--xs" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473683376.jpeg"></a></div></div><div class="ArticleFooter__user"><a href="http://qiita.com/TakesxiSximada/items/45b6d71a44f2706798ed/likers"><span class="fa fa-ellipsis-h"></span></a></div></div></div><div class="u-flex u-align-center"><div class="ArticleFooter__stock"><div class="js-stockbutton" data-position="footer_menu" data-props="{&quot;stock_status&quot;:false}"><div class="StockButton" data-reactroot=""><button><div class="StockButton__stock"><div class="fa-stack"><span class="fa fa-folder-open fa-stack-1x unstock"></span></div><!-- react-text: 6 -->&nbsp;<!-- /react-text --><span class="StockButton__label">Stock</span></div></button></div></div></div><div class="ArticleFooter__editRequest"><a data-original-title="You can propose improvements about the article to the author 💪" class="u-link-no-underline" data-toggle="tooltip" title="" href="http://qiita.com/drafts/45b6d71a44f2706798ed/edit"><span class="fa fa-send-o fa-lg"></span> <span>Edit request</span></a></div><div class="dropdown ArticleFooter__dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#"><span class="fa fa-ellipsis-h"></span></a><ul class="dropdown-menu dropdown-menu-right"><li><a href="http://qiita.com/TakesxiSximada/items/45b6d71a44f2706798ed.md"><span class="fa fa-fw fa-file-text-o"></span> Show article as Markdown</a></li><li><a data-target=".js-report-form" data-toggle="modal" href="#"><i class="fa fa-fw fa-flag"></i> Report article</a></li></ul></div></div></div><div class="itemsShowBody_adventCalendar"><div class="itemsShowBody_adventCalendar_header"><i class="fa fa-fw fa-calendar"></i> This post is the <span class="date">No.24</span> article of <a class="title" href="http://qiita.com/advent-calendar/2016/python">Python Advent Calendar 2016</a></div><ul class="itemsShowBody_adventCalendar_nav list-unstyled"><li class="itemsShowBody_adventCalendar_neighborItem itemsShowBody_adventCalendar_neighborItem-prev"><span class="itemsShowBody_adventCalendar_date"><i class="fa fa-fw fa-arrow-circle-left"></i> Day 23:</span><span class="itemsShowBody_adventCalendar_title"> <a class="itemsShowBody_adventCalendar_link" href="http://qiita.com/advent-calendar/2016/python#day-23">Prev</a></span></li><li class="itemsShowBody_adventCalendar_neighborItem itemsShowBody_adventCalendar_neighborItem-next"><span class="itemsShowBody_adventCalendar_date"><i class="fa fa-fw fa-arrow-circle-right"></i> Day 25:</span><span class="itemsShowBody_adventCalendar_title"><img alt="hanaken_Nirvana" class="itemsShowBody_adventCalendar_icon" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473703908.png" height="18" width="18"> <a class="itemsShowBody_adventCalendar_link" href="http://qiita.com/hanaken_Nirvana/items/d1a3efcf6ec65e2aec04">~Pythonistaより愛をこめて贈るPython入門者のためのTips③~</a></span></li></ul></div><ul class="references js-referencesView"><li class="references_header"><i class="fa fa-fw fa-link"></i> Linked from these articles</li><li class="references_reference js-reference"><span>Linked from </span><a href="http://qiita.com/Nao1215/items/6076c498fc6d64ec2f06#_reference-868392d1b7d39154e18e"><img alt="" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/1473707672.jpeg" height="18" width="18">Bash(Shell Script)、もう嫌：BashをPython3.xに置換するために調査した内容</a><time class="references_datetime js-dateTimeView" datetime="2016-12-27T12:30:44+00:00">7 months ago</time></li></ul><div class="itemsShowBody_articleColumnFooter"><div class="socialButtons"><div class="socialButtons_twitter"><iframe data-url="http://qiita.com/TakesxiSximada/items/45b6d71a44f2706798ed" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/tweet_button_002.html" title="Twitter Tweet Button" style="position: static; visibility: visible; width: 60px; height: 20px;" class="twitter-share-button twitter-share-button-rendered twitter-tweet-button" allowtransparency="true" scrolling="no" id="twitter-widget-1" frameborder="0"></iframe></div><div class="socialButtons_hatebu"><iframe style="width: 47px; height: 20px;" src="javascript:false" scrolling="no" title="Add to Hatena Bookmark" class="hatena-bookmark-button-frame" frameborder="0" height="20" width="47"></iframe><script async="async" charset="utf-8" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/bookmark_button.js" type="text/javascript"></script></div><div class="socialButtons_googlePlus"><div id="___plusone_1" style="text-indent: 0px; margin: 0px; padding: 0px; background: transparent none repeat scroll 0% 0%; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; display: inline-block; width: 32px; height: 20px;"><iframe title="G+" data-gapiattached="true" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/fastbutton_002.html" name="I1_1502057979643" id="I1_1502057979643" vspace="0" tabindex="0" style="position: static; top: 0px; width: 32px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 20px;" scrolling="no" marginwidth="0" marginheight="0" hspace="0" ng-non-bindable="" frameborder="0" width="100%"></iframe></div></div><div class="socialButtons_facebook"><div fb-iframe-plugin-query="action=like&amp;app_id=222621691108322&amp;container_width=0&amp;href=http%3A%2F%2Fqiita.com%2FTakesxiSximada%2Fitems%2F45b6d71a44f2706798ed&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey&amp;share=false&amp;show_faces=false" fb-xfbml-state="parsed" class="fb-like fb_iframe_widget" data-action="like" data-href="http://qiita.com/TakesxiSximada/items/45b6d71a44f2706798ed" data-layout="button_count" data-share="false" data-show-faces="false"><span style="vertical-align: top; width: 0px; height: 0px; overflow: hidden;"><iframe src="https://www.facebook.com/plugins/like.php?action=like&amp;app_id=222621691108322&amp;channel=http%3A%2F%2Fstaticxx.facebook.com%2Fconnect%2Fxd_arbiter%2Fr%2FXBwzv5Yrm_1.js%3Fversion%3D42%23cb%3Df33f969a6b8585%26domain%3Dqiita.com%26origin%3Dhttp%253A%252F%252Fqiita.com%252Ff34285751f604b8%26relation%3Dparent.parent&amp;container_width=0&amp;href=http%3A%2F%2Fqiita.com%2FTakesxiSximada%2Fitems%2F45b6d71a44f2706798ed&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey&amp;share=false&amp;show_faces=false" style="border: medium none; visibility: hidden;" title="fb:like Facebook Social Plugin" scrolling="no" allowfullscreen="true" allowtransparency="true" name="f143c8c245d08e" frameborder="0" height="1000px" width="1000px"></iframe></span></div></div><div class="socialButtons_pocket"><div class="pocket-btn"><iframe id="pocket-button-1" allowtransparency="true" scrolling="NO" src="https://widgets.getpocket.com/v1/button?label=pocket&amp;count=horizontal&amp;v=1&amp;url=http%3A%2F%2Fqiita.com%2FTakesxiSximada%2Fitems%2F45b6d71a44f2706798ed&amp;title=Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita&amp;src=http%3A%2F%2Fqiita.com%2FTakesxiSximada%2Fitems%2F45b6d71a44f2706798ed&amp;r=0.16410232488473342" frameborder="0" height="22" width="135"></iframe></div></div></div></div><div class="itemsShowComment_wrapper" id="comments"><script type="application/json" class="js-react-on-rails-component" data-component-name="PublicCommentListContainer" data-dom-id="PublicCommentListContainer-react-component-3d87065d-287d-48d9-9e25-6bda58b4ba0e">{"currentUser":null,"initialComments":[],"monthly_public_image_uploadable_size_limit":null,"total_uploaded_public_image_size_in_current_month":null,"item":{"id":454851,"uuid":"45b6d71a44f2706798ed","suspended":false,"secret":false},"owner":{"url_name":"TakesxiSximada"},"is_team":false,"is_project":false,"logged_in":false,"polling":false,"mention_candidates":[{"id":36261,"url_name":"TakesxiSximada","profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/36261/profile-images/1473687011"}]}</script>
    <div id="PublicCommentListContainer-react-component-3d87065d-287d-48d9-9e25-6bda58b4ba0e"><div class="commentList" data-reactroot=""><!-- react-empty: 2 --></div></div>
    
</div></div></div></div></article><div class="js-report-form modal fade reportForm"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button name="button" type="submit" class="close" data-dismiss="modal">×</button><h4 class="modal-title">Report article</h4></div><div class="modal-body"><form action="/reports" accept-charset="UTF-8" method="post"><input name="utf8" value="✓" type="hidden"><input name="authenticity_token" value="DsOMvTmcURwai36v3woZx8iR8Te1CdNBjxSWpPuwieqJPl2ssYq3JbqFWwFnr3ezRHebtHS2M/3PF9Gd+Z6o0w==" type="hidden"><input name="redirect_path" id="redirect_path" value="/TakesxiSximada/items/45b6d71a44f2706798ed" type="hidden"><input name="item_uuid" id="item_uuid" value="45b6d71a44f2706798ed" type="hidden"><p>Help us understand the problem. What is going on with this item?</p><br><div class="form-group"><ul class="list-unstyled"><li><label><input name="report_type" id="report_type_spam" value="spam" required="required" type="radio"> It's spam </label></li><li><label><input name="report_type" id="report_type_harassment" value="harassment" required="required" type="radio"> It's abusive or harmful </label></li><li><label><input name="report_type" id="report_type_inappropriate_content" value="inappropriate_content" required="required" type="radio"> It contains inappropriate content </label></li></ul></div><div class="reportForm_submitButtonContainer"><button name="button" type="submit" class="btn btn-primary reportForm_submitButton"><i class="fa fa-send"></i> Submit</button></div></form></div></div></div></div><script id="js-item" type="application/json">{ "url": "http://qiita.com/TakesxiSximada/items/45b6d71a44f2706798ed", "id": 454851, "uuid": "45b6d71a44f2706798ed" }</script><script class="js-user" type="application/json">{&quot;id&quot;:36261,&quot;url_name&quot;:&quot;TakesxiSximada&quot;,&quot;profile_image_url&quot;:&quot;https://qiita-image-store.s3.amazonaws.com/0/36261/profile-images/1473687011&quot;}</script><script language="JavaScript" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/qiita_bigmining.js" type="text/javascript"></script></div><footer class="footer"><div class="footer_inner"><div class="footer_container"><ul class="footer_links-left"><li class="footer_link"><a class="footer_copyright" href="http://increments.co.jp/">© 2011-2017 Increments Inc.</a></li><li class="footer_link"><a href="http://qiita.com/terms">Terms</a></li><li class="footer_link"><a href="http://qiita.com/privacy">Privacy</a></li><li class="footer_link"><a href="http://help.qiita.com/">Help</a></li><li class="footer_link"><a href="https://increments.zendesk.com/anonymous_requests/new">Contact</a></li></ul><ul class="footer_links-right"><li class="footer_link"><a href="http://qiita.com/about">About</a></li><li class="footer_link"><a href="http://qiita.com/users">Users</a></li><li class="footer_link"><a href="http://qiita.com/tags">Tags</a></li><li class="footer_link"><a href="http://blog.qiita.com/">Blog</a></li><li class="footer_link"><a href="http://qiita.com/api/v2/docs">API</a></li><li class="footer_link"><a href="https://teams.qiita.com/">Team</a></li><li class="footer_link"><a href="http://kobito.qiita.com/">Kobito</a></li><li class="footer_link"><a class="js-public-form-feedback-link" data-target=".js-feedback-form" data-toggle="modal" href=""><i class="fa fa-heart"></i> Feedback <i class="fa fa-caret-down"></i></a></li></ul></div></div></footer><div class="js-feedback-form modal fade feedbackForm"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button name="button" type="submit" class="close" data-dismiss="modal">×</button><h4 class="modal-title">Feedback</h4></div><div class="modal-body"><form class="js-feedback-form-form" action="/feedbacks" accept-charset="UTF-8" method="post"><input name="utf8" value="✓" type="hidden"><input name="authenticity_token" value="DsOMvTmcURwai36v3woZx8iR8Te1CdNBjxSWpPuwieqJPl2ssYq3JbqFWwFnr3ezRHebtHS2M/3PF9Gd+Z6o0w==" type="hidden"><input name="redirect_path" id="redirect_path" value="/TakesxiSximada/items/45b6d71a44f2706798ed" type="hidden"><div class="form-group"><textarea name="feedback[message]" id="feedback_message" class="form-control js-feedback-form-text-area" placeholder="Please give us any feedback about Qiita." required="required" rows="5"></textarea></div><div class="feedbackForm_submitButtonContainer"><button name="button" type="submit" class="btn btn-primary feedbackForm_submitButton"><i class="fa fa-send"></i> Submit</button><p class="feedbackForm_note">We don't reply to any feedback.<br>If you need help with Qiita, please send a support request from <a href="https://increments.zendesk.com/anonymous_requests/new">here</a>.</p></div><div style="position:fixed;top:-99999px;opacity:0.0001;"><input name="feedback[name]" type="text"></div></form></div></div></div></div><script>// if (window.mixpanel instanceof Element) {
//   window.mixpanel = [];
// }
// (function(f,b){if(!b.__SV){var a,e,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");
// for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="//cdn.mxpnl.com/libs/mixpanel-2.2.min.js";e=f.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}})(document,window.mixpanel||[]);</script><script src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/public-ebd05c3f120b426c3c720010d013f252.js"></script><div class=" fb_reset" id="fb-root"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe src="http://staticxx.facebook.com/connect/xd_arbiter/r/XBwzv5Yrm_1.js?version=42#channel=f34285751f604b8&amp;origin=http%3A%2F%2Fqiita.com" style="border: medium none;" tabindex="-1" title="Facebook Cross Domain Communication Frame" aria-hidden="true" id="fb_xdm_frame_http" scrolling="no" allowfullscreen="true" allowtransparency="true" name="fb_xdm_frame_http" frameborder="0"></iframe><iframe src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/XBwzv5Yrm_1_002.html" style="border: medium none;" tabindex="-1" title="Facebook Cross Domain Communication Frame" aria-hidden="true" id="fb_xdm_frame_https" scrolling="no" allowfullscreen="true" allowtransparency="true" name="fb_xdm_frame_https" frameborder="0"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe src="https://www.facebook.com/connect/ping?client_id=222621691108322&amp;domain=qiita.com&amp;origin=1&amp;redirect_uri=http%3A%2F%2Fstaticxx.facebook.com%2Fconnect%2Fxd_arbiter%2Fr%2FXBwzv5Yrm_1.js%3Fversion%3D42%23cb%3Df13f6668f553656%26domain%3Dqiita.com%26origin%3Dhttp%253A%252F%252Fqiita.com%252Ff34285751f604b8%26relation%3Dparent&amp;response_type=token%2Csigned_request%2Ccode&amp;sdk=joey" style="display: none;" scrolling="no" allowfullscreen="true" allowtransparency="true" name="f30510b0aca551a" frameborder="0"></iframe></div></div></div><script>
  (function () {
    var script = document.getElementsByTagName('script')[0];
    var load = function (src, id) {
      var el = document.createElement('script');
      el.async = true;
      el.src = src;
      el.id = id;
      script.parentNode.insertBefore(el, script);
    };
      // Optimizely
      load('https://cdn.optimizely.com/js/52738645.js', 'optimizely-jssdk');
      // Google Analytics
      window._gaq = window._gaq || [];
      window._gaq.push(['_setAccount', 'UA-24675221-1']);
      window._gaq.push(['_setCustomVar', 1, 'logged_in', 'false', 2]);
      window._gaq.push(['_trackPageview']);
      var src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      load(src, 'google-analytics-jssdk');
    // Google Analytics - Universal Analytics
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-24675221-12', {
          
        });
          ga('create', 'UA-57567225-1', { name: 'user' });
          ga('user.send', 'pageview');
        ga('set', 'dimension1', 'false');
        ga('set', 'dimension3', 'false');
      ga('require', 'displayfeatures');
      ga('set', 'forceSSL', true);
      ga('send', 'pageview');
    // Google Tag Manager
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-TBQWPN');
  })();
</script>
<div class="ReactModalPortal"><div data-reactroot=""></div></div><script src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/gpt.js" id="" type="text/javascript"></script><iframe aria-hidden="true" tabindex="-1" style="width: 1px; height: 1px; position: absolute; top: -100px;" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/postmessageRelay.html" id="oauth2relay625803431" name="oauth2relay625803431"></iframe>
<script id="" type="text/javascript">var googletag=googletag||{};googletag.cmd=googletag.cmd||[];
(function(f,b){b.cmd.push(function(){for(var h=[],n=document.querySelectorAll(".TagList span"),p=[],q={"c++":"cpp","c#":"csharp"},l,m=0,r=n.length;m<r;m++)l=n[m].textContent.toLowerCase(),p.push(q[l]||l);b.pubads().setTargeting("article_tags",p);992<=window.innerWidth?function(){var d="dfp-slot-between-body-and-comments-for-pc",c=["-left","-right"],g=336,e=280;c.forEach(function(a){b.defineSlot("/383564218/qiita.com_items-show_under-article"+a,[g,e],d+a).addService(b.pubads())});h.push(function(){var a=
f.querySelector("#article-body-wrapper .markdownContent");if(a){a=a.parentElement;var k=f.createElement("div");k.style.textAlign="center";c.forEach(function(a){var b=f.createElement("div");b.style.display="inline-block";b.style.margin="10px";var c=f.createElement("div");c.id=d+a;c.style.height=e+"px";c.style.width=g+"px";k.appendChild(b);b.appendChild(c)});a.appendChild(k);c.forEach(function(a){b.display(d+a)})}})}():function(){var d="dfp-slot-between-body-and-comments-for-mobile",c=336,g=280;b.defineSlot("/383564218/qiita.com_items-show_under-article-mobile",
[c,g],d).addService(b.pubads());h.push(function(){var e=f.querySelector("#article-body-wrapper .markdownContent");if(e){e=e.parentElement;var a=f.createElement("div");a.style.textAlign="center";var k=f.createElement("div");k.style.display="inline-block";k.style.margin="10px auto";var h=f.createElement("div");h.id=d;h.style.height=g+"px";h.style.width=c+"px";a.appendChild(k);k.appendChild(h);e.appendChild(a);b.display(d)}})}();768<=window.innerWidth&&function(){var d="dfp-slot-sidebar-top",c=300,g=
250;b.defineSlot("/383564218/qiita.com_items-show_sidebar-top",[c,g],d).addService(b.pubads());h.push(function(){var e=f.querySelector("#article-body-wrapper \x3e .col-sm-3");if(e){var a=f.createElement("div");a.id=d;a.style.width=c+"px";a.style.height=g+"px";a.style.marginBottom="20px";e.insertBefore(a,e.firstChild);b.display(d)}})}();(function(){var d="dfp-slot-sidebar-bottom",c=300,g=250;b.defineSlot("/383564218/qiita.com_items-show_sidebar-bottom",[c,g],d).addService(b.pubads());h.push(function(){var e=
f.querySelector(".scroll-chaser");if(e){var a=f.createElement("div");a.id=d;a.style.width=c+"px";a.style.height=g+"px";a.style.marginTop="10px";a.style.marginBottom="30px";e.insertBefore(a,e.firstChild);b.display(d)}})})();b.pubads().enableSingleRequest();b.pubads().collapseEmptyDivs();b.enableServices();setTimeout(function(){h.forEach(function(b){b()})},1E3)})})(document,googletag);</script><iframe title="Twitter analytics iframe" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: medium none;" allowfullscreen="true" allowtransparency="true" scrolling="no" id="rufous-sandbox" frameborder="0"></iframe><img style="display: none;" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/dmp" height="1" width="1" border="0"><img style="display: none;" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/pixel.png" height="1" width="1" border="0"><img style="display: none;" src="Python%E3%83%87%E3%83%90%E3%83%83%E3%82%B0Tips%20-%20Qiita_files/adsct.gif" height="1" width="1" border="0"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-58Z82M');</script></body></html>